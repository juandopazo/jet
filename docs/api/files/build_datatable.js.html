<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Jet</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.4.0/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <script src="http://yui.yahooapis.com/3.4.0/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            <h1><a href="../index.html"><img src="../assets/css/logo.png">Jet</a></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.1.2</em>
        </div>
    </div>
    <div class="yui3-g">

        <div id="sidebar" class="yui3-u">
            <div id="modules" class="sidebox">
    <div class="hd">
        <h2 class="no-toc">Modules</h2>
    </div>
    <div class="bd">
        <ul>
            
                <li><a href="../modules/anim.html">anim</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/appview.html">appview</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/array-extras.html">array-extras</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/base.html">base</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/button.html">button</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/container.html">container</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/cookie.html">cookie</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/datasource.html">datasource</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/datatable.html">datatable</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/deferred.html">deferred</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/dragdrop.html">dragdrop</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/escape.html">escape</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/form.html">form</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/history.html">history</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/imageloader.html">imageloader</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/io.html">io</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/io-xdr.html">io-xdr</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/json.html">json</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/layout.html">layout</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/log.html">log</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/menu.html">menu</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/node.html">node</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/node-deferred.html">node-deferred</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/oop.html">oop</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/paginator.html">paginator</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/progressbar.html">progressbar</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/resize.html">resize</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/selector.html">selector</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/sizzle.html">sizzle</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/swf.html">swf</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/tabview.html">tabview</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/touch.html">touch</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/transition.html">transition</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/treeview.html">treeview</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/vector.html">vector</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/widget-alignment.html">widget-alignment</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/widget-parentchild.html">widget-parentchild</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/widget-sandbox.html">widget-sandbox</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/widget-stack.html">widget-stack</a>
                
                    <ul>
                        
                    </ul>
                
                </li>
            
        </ul>
    </div>
</div>

<div id="classes" class="sidebox">
    <div class="hd">
        <h2 class="no-toc">Classes</h2>
    </div>
    <div class="bd">
        <ul>
            
                <li><a href="../classes/AppView.html">AppView</a></li>
            
                <li><a href="../classes/Array.html">Array</a></li>
            
                <li><a href="../classes/ArrayList.html">ArrayList</a></li>
            
                <li><a href="../classes/Attribute.html">Attribute</a></li>
            
                <li><a href="../classes/Base.html">Base</a></li>
            
                <li><a href="../classes/BuiltClass.html">BuiltClass</a></li>
            
                <li><a href="../classes/Button.html">Button</a></li>
            
                <li><a href="../classes/ButtonGroup.html">ButtonGroup</a></li>
            
                <li><a href="../classes/Cell.html">Cell</a></li>
            
                <li><a href="../classes/CheckBox.html">CheckBox</a></li>
            
                <li><a href="../classes/Class.html">Class</a></li>
            
                <li><a href="../classes/Column.html">Column</a></li>
            
                <li><a href="../classes/ComboBox.html">ComboBox</a></li>
            
                <li><a href="../classes/ComboOption.html">ComboOption</a></li>
            
                <li><a href="../classes/Cookie.html">Cookie</a></li>
            
                <li><a href="../classes/Core.html">Core</a></li>
            
                <li><a href="../classes/DataSource.html">DataSource</a></li>
            
                <li><a href="../classes/DataSource.Ajax.html">DataSource.Ajax</a></li>
            
                <li><a href="../classes/DataSource.Get.html">DataSource.Get</a></li>
            
                <li><a href="../classes/DataSource.Local.html">DataSource.Local</a></li>
            
                <li><a href="../classes/DataSource.XDR.html">DataSource.XDR</a></li>
            
                <li><a href="../classes/DataTable.html">DataTable</a></li>
            
                <li><a href="../classes/Deferred.html">Deferred</a></li>
            
                <li><a href="../classes/DOM.html">DOM</a></li>
            
                <li><a href="../classes/DOMEventHandler.html">DOMEventHandler</a></li>
            
                <li><a href="../classes/Drag.html">Drag</a></li>
            
                <li><a href="../classes/DragDrop.html">DragDrop</a></li>
            
                <li><a href="../classes/Easing.html">Easing</a></li>
            
                <li><a href="../classes/Escape.html">Escape</a></li>
            
                <li><a href="../classes/Event.Cache.html">Event.Cache</a></li>
            
                <li><a href="../classes/EventFacade.html">EventFacade</a></li>
            
                <li><a href="../classes/EventTarget.html">EventTarget</a></li>
            
                <li><a href="../classes/FanLoader.html">FanLoader</a></li>
            
                <li><a href="../classes/FieldSet.html">FieldSet</a></li>
            
                <li><a href="../classes/Form.html">Form</a></li>
            
                <li><a href="../classes/FormField.html">FormField</a></li>
            
                <li><a href="../classes/Frame.html">Frame</a></li>
            
                <li><a href="../classes/Get.html">Get</a></li>
            
                <li><a href="../classes/History.html">History</a></li>
            
                <li><a href="../classes/Image.html">Image</a></li>
            
                <li><a href="../classes/ImageLoader.html">ImageLoader</a></li>
            
                <li><a href="../classes/IO.html">IO</a></li>
            
                <li><a href="../classes/jet.html">jet</a></li>
            
                <li><a href="../classes/jet~deferred.html">jet~deferred</a></li>
            
                <li><a href="../classes/JSON.html">JSON</a></li>
            
                <li><a href="../classes/Lang.html">Lang</a></li>
            
                <li><a href="../classes/Layout.html">Layout</a></li>
            
                <li><a href="../classes/LayoutPanel.html">LayoutPanel</a></li>
            
                <li><a href="../classes/LayoutPanelBase.html">LayoutPanelBase</a></li>
            
                <li><a href="../classes/Log.html">Log</a></li>
            
                <li><a href="../classes/Module.html">Module</a></li>
            
                <li><a href="../classes/Mouse.html">Mouse</a></li>
            
                <li><a href="../classes/NodeList.html">NodeList</a></li>
            
                <li><a href="../classes/Object.html">Object</a></li>
            
                <li><a href="../classes/Overlay.html">Overlay</a></li>
            
                <li><a href="../classes/Page.html">Page</a></li>
            
                <li><a href="../classes/Paginator.html">Paginator</a></li>
            
                <li><a href="../classes/Panel.html">Panel</a></li>
            
                <li><a href="../classes/PanelBase.html">PanelBase</a></li>
            
                <li><a href="../classes/ProgressBar.html">ProgressBar</a></li>
            
                <li><a href="../classes/RadioButton.html">RadioButton</a></li>
            
                <li><a href="../classes/RadioGroup.html">RadioGroup</a></li>
            
                <li><a href="../classes/Record.html">Record</a></li>
            
                <li><a href="../classes/RecordSet.html">RecordSet</a></li>
            
                <li><a href="../classes/Resize.html">Resize</a></li>
            
                <li><a href="../classes/Sandbox.html">Sandbox</a></li>
            
                <li><a href="../classes/Scrollable.html">Scrollable</a></li>
            
                <li><a href="../classes/SimpleDialog.html">SimpleDialog</a></li>
            
                <li><a href="../classes/StaticPanel.html">StaticPanel</a></li>
            
                <li><a href="../classes/SWF.html">SWF</a></li>
            
                <li><a href="../classes/Tab.html">Tab</a></li>
            
                <li><a href="../classes/TabView.html">TabView</a></li>
            
                <li><a href="../classes/TimeFrame.html">TimeFrame</a></li>
            
                <li><a href="../classes/ToggleButton.html">ToggleButton</a></li>
            
                <li><a href="../classes/Tooltip.html">Tooltip</a></li>
            
                <li><a href="../classes/TreeNode.html">TreeNode</a></li>
            
                <li><a href="../classes/TreeView.html">TreeView</a></li>
            
                <li><a href="../classes/Tween.html">Tween</a></li>
            
                <li><a href="../classes/UA.html">UA</a></li>
            
                <li><a href="../classes/Utility.html">Utility</a></li>
            
                <li><a href="../classes/Vector.html">Vector</a></li>
            
                <li><a href="../classes/Vector.Circle.html">Vector.Circle</a></li>
            
                <li><a href="../classes/Vector.Ellipse.html">Vector.Ellipse</a></li>
            
                <li><a href="../classes/Vector.Image.html">Vector.Image</a></li>
            
                <li><a href="../classes/Vector.Line.html">Vector.Line</a></li>
            
                <li><a href="../classes/Vector.Path.html">Vector.Path</a></li>
            
                <li><a href="../classes/Vector.Rectangle.html">Vector.Rectangle</a></li>
            
                <li><a href="../classes/Vector.RoundedRectangle.html">Vector.RoundedRectangle</a></li>
            
                <li><a href="../classes/Vector.Text.html">Vector.Text</a></li>
            
                <li><a href="../classes/VectorView.html">VectorView</a></li>
            
                <li><a href="../classes/Widget.html">Widget</a></li>
            
                <li><a href="../classes/WidgetAlignment.html">WidgetAlignment</a></li>
            
                <li><a href="../classes/WidgetChild.html">WidgetChild</a></li>
            
                <li><a href="../classes/WidgetParent.html">WidgetParent</a></li>
            
                <li><a href="../classes/WidgetStack.html">WidgetStack</a></li>
            
        </ul>
    </div>
</div>










<div id="fileTree" class="sidebox">
    <div class="hd">
        <h2 class="no-toc">Files</h2>
    </div>
    <div class="bd">
        <ul><li>build/<ul><li><a href="../files/build_anim.js.html">anim.js</a></li><li><a href="../files/build_anim.min.js.html">anim.min.js</a></li><li><a href="../files/build_appview.js.html">appview.js</a></li><li><a href="../files/build_appview.min.js.html">appview.min.js</a></li><li><a href="../files/build_array-extras.js.html">array-extras.js</a></li><li><a href="../files/build_array-extras.min.js.html">array-extras.min.js</a></li><li><a href="../files/build_base.js.html">base.js</a></li><li><a href="../files/build_base.min.js.html">base.min.js</a></li><li><a href="../files/build_button.js.html">button.js</a></li><li><a href="../files/build_button.min.js.html">button.min.js</a></li><li><a href="../files/build_container.js.html">container.js</a></li><li><a href="../files/build_container.min.js.html">container.min.js</a></li><li><a href="../files/build_cookie.js.html">cookie.js</a></li><li><a href="../files/build_cookie.min.js.html">cookie.min.js</a></li><li><a href="../files/build_datasource.js.html">datasource.js</a></li><li><a href="../files/build_datasource.min.js.html">datasource.min.js</a></li><li><a href="../files/build_datatable.js.html">datatable.js</a></li><li><a href="../files/build_datatable.min.js.html">datatable.min.js</a></li><li><a href="../files/build_deferred.js.html">deferred.js</a></li><li><a href="../files/build_deferred.min.js.html">deferred.min.js</a></li><li><a href="../files/build_dragdrop.js.html">dragdrop.js</a></li><li><a href="../files/build_dragdrop.min.js.html">dragdrop.min.js</a></li><li><a href="../files/build_escape.js.html">escape.js</a></li><li><a href="../files/build_escape.min.js.html">escape.min.js</a></li><li><a href="../files/build_form.js.html">form.js</a></li><li><a href="../files/build_form.min.js.html">form.min.js</a></li><li><a href="../files/build_history.js.html">history.js</a></li><li><a href="../files/build_history.min.js.html">history.min.js</a></li><li><a href="../files/build_imageloader.js.html">imageloader.js</a></li><li><a href="../files/build_imageloader.min.js.html">imageloader.min.js</a></li><li><a href="../files/build_io-xdr.js.html">io-xdr.js</a></li><li><a href="../files/build_io-xdr.min.js.html">io-xdr.min.js</a></li><li><a href="../files/build_io.js.html">io.js</a></li><li><a href="../files/build_io.min.js.html">io.min.js</a></li><li><a href="../files/build_jet.js.html">jet.js</a></li><li><a href="../files/build_jet.min.js.html">jet.min.js</a></li><li><a href="../files/build_json.js.html">json.js</a></li><li><a href="../files/build_json.min.js.html">json.min.js</a></li><li><a href="../files/build_layout.js.html">layout.js</a></li><li><a href="../files/build_layout.min.js.html">layout.min.js</a></li><li><a href="../files/build_log.js.html">log.js</a></li><li><a href="../files/build_log.min.js.html">log.min.js</a></li><li><a href="../files/build_menu.js.html">menu.js</a></li><li><a href="../files/build_menu.min.js.html">menu.min.js</a></li><li><a href="../files/build_node-deferred.js.html">node-deferred.js</a></li><li><a href="../files/build_node-deferred.min.js.html">node-deferred.min.js</a></li><li><a href="../files/build_oop.js.html">oop.js</a></li><li><a href="../files/build_oop.min.js.html">oop.min.js</a></li><li><a href="../files/build_paginator.js.html">paginator.js</a></li><li><a href="../files/build_paginator.min.js.html">paginator.min.js</a></li><li><a href="../files/build_progressbar.js.html">progressbar.js</a></li><li><a href="../files/build_progressbar.min.js.html">progressbar.min.js</a></li><li><a href="../files/build_resize.js.html">resize.js</a></li><li><a href="../files/build_resize.min.js.html">resize.min.js</a></li><li><a href="../files/build_selector.js.html">selector.js</a></li><li><a href="../files/build_selector.min.js.html">selector.min.js</a></li><li><a href="../files/build_sizzle.js.html">sizzle.js</a></li><li><a href="../files/build_sizzle.min.js.html">sizzle.min.js</a></li><li><a href="../files/build_swf.js.html">swf.js</a></li><li><a href="../files/build_swf.min.js.html">swf.min.js</a></li><li><a href="../files/build_tabview.js.html">tabview.js</a></li><li><a href="../files/build_tabview.min.js.html">tabview.min.js</a></li><li><a href="../files/build_touch.js.html">touch.js</a></li><li><a href="../files/build_touch.min.js.html">touch.min.js</a></li><li><a href="../files/build_transition.js.html">transition.js</a></li><li><a href="../files/build_transition.min.js.html">transition.min.js</a></li><li><a href="../files/build_treeview.js.html">treeview.js</a></li><li><a href="../files/build_treeview.min.js.html">treeview.min.js</a></li><li><a href="../files/build_vector.js.html">vector.js</a></li><li><a href="../files/build_vector.min.js.html">vector.min.js</a></li><li><a href="../files/build_widget-alignment.js.html">widget-alignment.js</a></li><li><a href="../files/build_widget-alignment.min.js.html">widget-alignment.min.js</a></li><li><a href="../files/build_widget-parentchild.js.html">widget-parentchild.js</a></li><li><a href="../files/build_widget-parentchild.min.js.html">widget-parentchild.min.js</a></li><li><a href="../files/build_widget-sandbox.js.html">widget-sandbox.js</a></li><li><a href="../files/build_widget-sandbox.min.js.html">widget-sandbox.min.js</a></li><li><a href="../files/build_widget-stack.js.html">widget-stack.js</a></li><li><a href="../files/build_widget-stack.min.js.html">widget-stack.min.js</a></li></ul></li></ul>
    </div>
</div>



        </div>

        <div id="main" class="yui3-u">
            <div class="content"><h4>build/datatable.js</h4>

<pre class="code prettyprint linenums">
/**
 * Provides a DataTable widget that can be sorted and linked to a DataSource
 * @module datatable
 * @requires base
 * 
 * Copyright (c) 2011, Juan Ignacio Dopazo. All rights reserved.
 * Code licensed under the BSD License
 * https://github.com/juandopazo/jet/blob/master/LICENSE.md
*/
jet.add('datatable', function ($) {

			
var Hash = $.Hash,
	A = $.Array,
	Base = $.Base,
	Widget = $.Widget,
	Record = $.Record,
	RecordSet = $.RecordSet;	
	
/**
 * A cell in a DataTable
 * @class Cell
 * @constructor
 * @extends Base
 */
var Cell = Base.create('cell', Base, [], {
	ATTRS: {
		/**
		 * @attribute value
		 * @description The cell's value
		 * @required
		 * @writeOnce
		 */
		value: {
			required: true,
			writeOnce: true
		},
		/**
		 * @attribute td
		 * @description The cell's td
		 * @required
		 * @writeOnce
		 */
		td: {
			required: true,
			writeOnce: true
		},
		/**
		 * @attribute record
		 * @description The cell's record
		 * @required
		 * @writeOnce
		 */
		record: {
			required: true,
			writeOnce: true
		}
	}
});
var CELLS = 'cells',
	TD = 'td';

/**
 * Represents a column in a DataTable
 * @class Column
 * @extends Base
 * @constructor
 */
var Column = Base.create('column', Base, [], {
	
	ATTRS: {
		/**
		 * @attribute cells
		 * @description A list of cells
		 * @required true
		 * @writeOnce
		 */
		cells: {
			required: true,
			writeOnce: true
		}
	}
	
}, {
	
	/**
	 * @method getFirstTd
	 * @description Returns the first td element in this column
	 * @return HTMLElement 
	 */
	getFirstTd: function () {
		return this.get(CELLS)[0].get(TD);
	},
	
	/**
	 * @method getNextTd
	 * @description Returns the following td in this column, based on the one passed as a parameter
	 * @param {HTMLElement} td The previous td
	 * @return HTMLElement
	 */
	getNextTd: function (td) {
		var cells = this.get(CELLS), length = cells.length, i;
		for (i = 0; i &lt; length; i++) {
			if (cells[i].get(TD) == td) {
				break;
			}
		}
		return i &lt; length - 2 ? cells[++i].get(TD) : null; 
	},
	
	/**
	 * @method getFirstCell
	 * @description Gets the first Cell instance in this column
	 * @return Cell
	 */
	getFirstCell: function () {
		return this.get(CELLS)[0];
	},
	
	/**
	 * @method getNextCell
	 * @description Returns the following cell in this collumn base on the one passed as a parameter
	 * @param {Cell} td The previous cell
	 * @return Cell
	 */
	getNextCell: function (cell) {
		var cells = this.get(CELLS), length = cells.length, i;
		for (i = 0; i &lt; length; i++) {
			if (cells[i] == cell) {
				break;
			}
		}
		return i &lt; length - 2 ? cells[++i] : null; 
	}
});
var Lang = $.Lang,
	DATA = "data",
	ASC = "asc",
	DESC = "desc",
	ODD = "odd",
	EVEN = "even",
	REC = "rec",
	LINER = "liner",
	NUMERAL = "#",
	DOT = ".",
	ID = "id",
	SORTABLE = "sortable",
	NEW_DIV = "&lt;div/&gt;",
	THEAD = 'thead',
	TBODY = 'tbody',
	RECORDSET = 'recordSet',
	SORTED_BY = 'sortedBy',
	RECORD_ID_PREFIX = 'recordIdPrefix',
	BOUNDING_BOX = 'boundingBox',
	COLUMN_DEFINITIONS = "columnDefinitions";
	
/**
 * A DataTable is an HTML table that can be sorted and linked to a DataSource
 * @class DataTable
 * @extends Widget
 * @param {Object} config Object literal specifying widget configuration properties
 * @constructor
 */
var DataTable = Base.create('dt', Widget, [], {
	
	ATTRS: {
		/**
		 * @attribute recordSet
		 * @description The data table's associated recordSet
		 * @type RecordSet
		 */
		recordSet: {},
		/**
		 * @attribute columnDefinitions
		 * @description An array mapping record keys to columns
		 * @required
		 * @type Array
		 */
		columnDefinitions: {
			required: true,
			validator: Lang.isArray
		},
		
		thead: {
			value: '&lt;thead/&gt;',
			setter: $
		},
		tbody: {
			value: '&lt;tbody/&gt;',
			setter: $
		},
		
		recordIdPrefix: {
			readOnly: true,
			getter: function () {
				return this.getClassName(this._uid + REC);
			}
		}
	}
	
}, {
	
	CONTENT_TEMPLATE: '&lt;table/&gt;',
	
	initializer: function () {
		this.set(THEAD, this.get(THEAD));
		this.set(TBODY, this.get(TBODY));
		if (!this.get(RECORDSET)) {
			this.set(RECORDSET, new $.RecordSet());
		}
	},
	
	renderUI: function () {
		var contentBox = this.get('contentBox');
		contentBox.getDOMNode().setAttribute('cellspacing', '0px');
		var thead = this.get(THEAD);
		var tbody = this.get(TBODY);
		
		this._setupTableHeaders();
		
		thead.appendTo(contentBox);
		tbody.addClass(this.getClassName(DATA)).appendTo(contentBox);
	},
	
	syncUI: function () {
		this.onDataReturnAddRows({
			target: this,
			type: 'update',
			data: this.get(RECORDSET)
		});
	},
	
	_onThClick: function (e) {
		e.stopPropagation();
		e.preventDefault();
		var target = e.target;
		var parent = this.get(THEAD).first().getDOMNode();
		while (target.parentNode != parent) {
			target = target.parentNode;
		}
		this._sort($(target));
	},
	
	_setupTableHeaders: function () {
		var colDefs = this.get(COLUMN_DEFINITIONS);
		var getClassName = $.bind(this.getClassName, this);
		var linerClassName = getClassName(LINER);
		var labelClassname = getClassName('label');
		var sortableClassName = getClassName(SORTABLE);
		var uid = this._uid;
		var self = this;
		var thead = this.get(THEAD);
		var theadRow = $('&lt;tr/&gt;').addClass(getClassName('first'), getClassName('last')).appendTo(thead);
		A.each(colDefs, function (colDef, i) {
			var content = $("&lt;span/&gt;").addClass(labelClassname).html(colDef.label || colDef.key);
			var liner = $(NEW_DIV).addClass(linerClassName).append(content);
			var th = $("&lt;th/&gt;").append(liner);
			th.attr(ID, getClassName(uid, 'th', colDef.key));
			if (i === 0) {
				th.addClass(getClassName('first'));
			} else if (i == colDefs.length - 1) {
				th.addClass(getClassName('last'));
			}
			th.addClass(getClassName('col', colDef.key));
			if (colDef.sortable) {
				self._handlers.push(th.addClass(sortableClassName).on('click', self._onThClick, self));
			}
			if (Lang.isNumber(colDef.width)) {
				th.width(colDef.width);
			}
			theadRow.append(th);
		});
	},
	
	_sort: function (th, keepOrder) {
		var getClassName = $.bind(this.getClassName, this);
		var key = th.attr(ID).split("-").pop();
		var classNameDESC = getClassName(DESC);
		var isDesc = th.hasClass(classNameDESC);
		var order = isDesc ? DESC : ASC;
		var unorder = isDesc ? ASC : DESC;
		var i;
		var thead = this.get(THEAD);
		var tbody = this.get(TBODY);
		var recordSet = this.get(RECORDSET);
		var sortedBy = this.get(SORTED_BY);
		var recordIdPrefix = this.get(RECORD_ID_PREFIX);
		if (!keepOrder) {
			i = order;
			order = unorder;
			unorder = i;
		}
		/*
		 * Add/remove respective classes
		 */
		thead.find("th").removeClass(getClassName(order), getClassName(unorder));
		th.addClass(getClassName(order)).removeClass(getClassName(unorder));
		// Sort recordset
		recordSet.sortBy(key, order);
		sortedBy = key;
		
		var records = recordSet.getRecords();
		var length = records.length;
		var before, after, children;
		var even = getClassName(length % 2 === 0 ? EVEN : ODD);
		var odd = getClassName(length % 2 === 0 ? ODD : EVEN);
		$(NUMERAL + recordIdPrefix + records[length - 1].getId()).addClass(length % 2 === 0 ? odd : even).removeClass(length % 2 === 0 ? even : odd);
		for (i = length - 2; i &gt;= 0; i--) {
			before = tbody.find(NUMERAL + recordIdPrefix + records[i].getId());
			after = tbody.find(NUMERAL + recordIdPrefix + records[i + 1].getId());
			before.insertBefore(after);
		}
		children = tbody.children();
		for (i = 0; i &lt; length; i++) {
			children.item(i).addClass(i % 2 === 0 ? even : odd).removeClass(i % 2 === 0 ? odd : even);
		}
		tbody.find(DOT + classNameDESC).removeClass(classNameDESC);
		tbody.find(DOT + getClassName('col', key)).addClass(classNameDESC);
	},
	
	_addRow: function (row) {
		if (this.fire('addRow', { data: row })) {
			if (!$.instanceOf(row, Record)) {
				row = new $.Record(row);
			}
			var recordIdPrefix = this.get(RECORD_ID_PREFIX);
			var tr = $("&lt;tr/&gt;").attr(ID, recordIdPrefix + row.getId());
			var getClassName = $.bind(this.getClassName, this);
			var tbody = this.get(TBODY);
			A.each(this.get(COLUMN_DEFINITIONS), function (colDef) {
				var text = row.get(colDef.key);
				var td = $("&lt;td/&gt;").addClass(getClassName('col', colDef.key));
				var content = colDef.formatter ? colDef.formatter.call(this, text, row.getData(), td) : text;
				var liner = $(NEW_DIV).addClass(getClassName(LINER));
				if (Lang.isString(content)) {
					liner.html(content);
				} else {
					liner.append(content);
				}
				td.append(liner).appendTo(tr);
			}, this);
			tr.addClass(getClassName(tbody.children().size() % 2 === 0 ? EVEN : ODD)).appendTo(tbody);
			this.fire('afterAddRow', { tr: tr, data: row });
		}
		return tr;
	},
	
	/**
	 * Adds a row
	 * @method addRow
	 * @param {Record|HTMLRowElement|Array} row
	 * @chainable
	 */
	addRow: function (row) {
		this._addRow(row);
		var sortedBy = this.get(SORTED_BY);
		if (sortedBy) {
			this._sort($(NUMERAL + this.getClassName(this._uid, 'th', sortedBy)));
		}
		return this;
	},
	
	/**
	 * Adds several rows
	 * @method addRows
	 * @param {Array} rows
	 * @chainable
	 */
	addRows: function (rows) {
		if (this.fire('addRows', { data: rows })) {
			if (Lang.isArray(rows)) {
				A.each(rows, function (row) {
					if (!$.instanceOf(row, Record)) {
						row = new $.Record(row);
					}
				});
			} else if ($.instanceOf(rows, RecordSet)) {
				rows = rows.getRecords();
			}
			var trs = [];
			A.each(rows, function (row) {
				trs.push(this._addRow(row));
			}, this);
			var sortedBy = this.get(SORTED_BY);
			if (sortedBy) {
				this._sort($(NUMERAL + this.getClassName(this._uid, 'th', sortedBy)), true);
			}
			this.fire('afterAddRows', { data: rows, trs: trs });
		}
		return this;
	},
	
	/*@TODO
	deleteRow: function () {
		
	},
	
	deleteRows: function () {
		
	},
	*/
	
	/**
	 * Returns a column based on an index or the column's key
	 * @method getColumn
	 * @param {Number | String} id
	 * @return Column
	 */
	getColumn: function (id) {
		var col, cells = [], i, records = this.get(RECORDSET).getRecords(), length = records.length;
		var colDefs = this.get(COLUMN_DEFINITIONS);
		var rows = this.get(TBODY).children(), key = Lang.isNumber(id) ? colDefs[id].key : id;
		var index = id;
		if (!Lang.isNumber(id)) {
			for (i = 0; i &lt; colDefs.length; i++) {
				if (colDefs[i].key == id) {
					index = i;
					break;
				}
			}
		}
		for (i = 0; i &lt; length; i++) {
			cells[cells.length] = new Cell({
				record: records[i],
				td: rows.item(i).children().item(index),
				value: records[i].get(key)
			});
		}
		return new Column({
			cells: cells
		});
	},

	/**
	 * Returns the first html row element in the table
	 * @method getFirstTr
	 * @return NodeList
	 */
	getFirstTr: function () {
		return this.get(TBODY).children().item(0);
	},
	
	/**
	 * Returns the next html row element base on the one passed as a parameter
	 * @method getNextTr
	 * @param {Record | HTMLTrElement | NodeList | Number} tr
	 * @return NodeList
	 */
	getNextTr: function (tr) {
		if ($.instanceOf(tr, Record)) {
			tr = tr.getId();
		}
		if (Lang.isNumber(tr)) {
			tr = this.get(TBODY).find(NUMERAL + this.get(RECORD_ID_PREFIX) + tr);
		}
		return tr.next();
	},
	
	/**
	 * Returns the first cell element in a row
	 * @method getFirstTd
	 * @param {Record | HTMLTrElement | NodeList | Number} row
	 * @return NodeList
	 */
	getFirstTd: function (row) {
		if ($.instanceOf(row, Record)) {
			row = row.getId();
		}
		if (Lang.isNumber(row)) {
			row = this.get(TBODY).find(NUMERAL + this.get(RECORD_ID_PREFIX) + row);
		}
		return row.children().item(0);
	},
	
	/**
	 * Returns the next cell element in a row based on the one passed as a parameter
	 * @method getNextTd
	 * @param {Record | HTMLTrElement | NodeList | Number} td
	 * @return NodeList
	 */
	getNextTd: function (td) {
		if ($.instanceOf(td, Record)) {
			td = td.getId();
		}
		if (Lang.isNumber(td)) {
			td = this.get(TBODY).find(NUMERAL + this.get(RECORD_ID_PREFIX) + td).children(td - 1);
		}
		return td.next();
	},
	
	/*@TODO
	getSelectedCell: function () {
		
	},
	
	myself.getSelectedRow = function () {
		
	};
	
	getSelectedColumn = function () {
		
	},
	
	selectCell = function (cell) {
		
	},
	
	selectRow = function (row) {
		
	},
	
	selectColumn = function (col) {
		
	},
	
	unselectCell = function (cell) {
		
	},
	
	unselectRow = function (row) {
		
	},
	
	unselectColumn = function (col) {
		
	},
	
	unselectAll = function () {
		
	},*/
	
	/**
	 * Replace all rows when the DataSource updates
	 * @method onDataReturnReplaceRows
	 * @param {EventFacade} e
	 * @param {RecordSet} recordSet
	 */
	onDataReturnReplaceRows: function (e) {
		this.get(TBODY).children().remove();
		this.get(RECORDSET).replace(e.data);
		this.addRows(e.data);
	},
	
	/**
	 * When the DataSource updates, treat the returned data as additions to the table's recordSet
	 * @method onDataReturnAddRows
	 * @param {EventFacade} e
	 * @param {RecordSet} newRecordSet
	 */
	onDataReturnAddRows: function (e) {
		var recordSet = this.get(RECORDSET);
		recordSet.push.apply(recordSet, e.data._items);
		this.addRows(e.data);
	}
	
});
$.ScrollingDataTable = Base.create('dt', DataTable, [], {
	
	ATTRS: {
		tbodyContainer: {
			value: '&lt;div/&gt;',
			setter: $
		},
		
		/**
		 * @attribute autoScroll
		 * @description Scroll the datatable automatically to the bottom when the rows change and the scroll was already at the bottom
		 * @default false
		 */
		autoScroll: {
			value: false
		},
		
		autoScrollStatus: {
			value: false
		}
	}
	
}, {
	
	initializer: function () {
		this.set('tbodyContainer', this.get('tbodyContainer'));
	},
	
	_autoScrollBefore: function () {
		var tbodyContainer = this.get('tbodyContainer');
		this.set('autoScrollStatus', (tbodyContainer.getDOMNode().scrollTop + tbodyContainer.height() == tbodyContainer.getDOMNode().scrollHeight));
	},
	
	_autoScrollAfter: function () {
		var tbodyContainer = this.get('tbodyContainer');
		if (this.get('autoScroll') &amp;&amp; this.get('autoScrollStatus')) {
			tbodyContainer.getDOMNode().scrollTop = tbodyContainer.getDOMNode().scrollHeight;
		}
	},
	
	_syncColumnWidths: function () {
		var ths = this.get(THEAD).first().children();
		if (!this._firstTr || !this._firstTr.getDOMNode() || !this._firstTr.getDOMNode().parentNode) {
			this._firstTr = this.getFirstTr();
		}
		this._firstTr.children().each(function (td, i) {
			$(td).width(ths.item(i).width());
		});
	},
	
	_sdtAfterRender: function () {
		var height = this.get('height');
		var container = this.get('tbodyContainer');
		if (height) {
			container.height(height - this.get(THEAD).height());
		}
		this._contentTable.append(this.get(TBODY).remove()).appendTo(container);
		this._syncColumnWidths();
	},
	
	renderUI: function (boundingBox) {
		var table = this._contentTable = $("&lt;table/&gt;").addClass(this.getClassName('content'));
		table.getDOMNode().setAttribute('cellspacing', '0');
		this.get('tbodyContainer').addClass(this.getClassName('table', 'body')).appendTo(boundingBox).css("overflowY", "auto");
		
		this.after('render', this._sdtAfterRender);
	},
	
	bindUI: function () {
		this.after('addRow', this._syncColumnWidths);
		this.after('addRows', this._syncColumnWidths);
		this.on('addRow', this._autoScrollBefore);
		this.after('addRow', this._autoScrollAfter);
		this.on('addRows', this._autoScrollBefore);
		this.after('addRows', this._autoScrollAfter);

		this._handlers.push($($.config.win).on('resize', this._syncColumnWidths, this));
	}
	
});

$.add({
	DataTable: DataTable,
	Column: Column
});
			
});

</pre>

</div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/js/tabs.js"></script>
</body>
</html>
