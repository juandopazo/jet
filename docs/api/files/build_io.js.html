<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>build\io.js - Jet</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.5.0pr4&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.5.0pr4&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title="Jet"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.1.2</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/$.html">$</a></li>
            
                <li><a href="..&#x2F;classes/Button.html">Button</a></li>
            
                <li><a href="..&#x2F;classes/ButtonGroup.html">ButtonGroup</a></li>
            
                <li><a href="..&#x2F;classes/CheckBox.html">CheckBox</a></li>
            
                <li><a href="..&#x2F;classes/Cookie.html">Cookie</a></li>
            
                <li><a href="..&#x2F;classes/DataSource.html">DataSource</a></li>
            
                <li><a href="..&#x2F;classes/DataSource.Ajax.html">DataSource.Ajax</a></li>
            
                <li><a href="..&#x2F;classes/DataSource.Get.html">DataSource.Get</a></li>
            
                <li><a href="..&#x2F;classes/DataSource.Local.html">DataSource.Local</a></li>
            
                <li><a href="..&#x2F;classes/DataSource.XDR.html">DataSource.XDR</a></li>
            
                <li><a href="..&#x2F;classes/Escape.html">Escape</a></li>
            
                <li><a href="..&#x2F;classes/FieldSet.html">FieldSet</a></li>
            
                <li><a href="..&#x2F;classes/Form.html">Form</a></li>
            
                <li><a href="..&#x2F;classes/FormField.html">FormField</a></li>
            
                <li><a href="..&#x2F;classes/IO.html">IO</a></li>
            
                <li><a href="..&#x2F;classes/JSON.html">JSON</a></li>
            
                <li><a href="..&#x2F;classes/Layout.html">Layout</a></li>
            
                <li><a href="..&#x2F;classes/LayoutPanel.html">LayoutPanel</a></li>
            
                <li><a href="..&#x2F;classes/LayoutPanelBase.html">LayoutPanelBase</a></li>
            
                <li><a href="..&#x2F;classes/Log.html">Log</a></li>
            
                <li><a href="..&#x2F;classes/Paginator.html">Paginator</a></li>
            
                <li><a href="..&#x2F;classes/ProgressBar.html">ProgressBar</a></li>
            
                <li><a href="..&#x2F;classes/Promise.html">Promise</a></li>
            
                <li><a href="..&#x2F;classes/RadioButton.html">RadioButton</a></li>
            
                <li><a href="..&#x2F;classes/RadioGroup.html">RadioGroup</a></li>
            
                <li><a href="..&#x2F;classes/Record.html">Record</a></li>
            
                <li><a href="..&#x2F;classes/RecordSet.html">RecordSet</a></li>
            
                <li><a href="..&#x2F;classes/SelectField.html">SelectField</a></li>
            
                <li><a href="..&#x2F;classes/SWF.html">SWF</a></li>
            
                <li><a href="..&#x2F;classes/ToggleButton.html">ToggleButton</a></li>
            
                <li><a href="..&#x2F;classes/TreeNode.html">TreeNode</a></li>
            
                <li><a href="..&#x2F;classes/TreeView.html">TreeView</a></li>
            
                <li><a href="..&#x2F;classes/WidgetChild.html">WidgetChild</a></li>
            
                <li><a href="..&#x2F;classes/WidgetParent.html">WidgetParent</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="..&#x2F;modules/array-extras.html">array-extras</a></li>
            
                <li><a href="..&#x2F;modules/button.html">button</a></li>
            
                <li><a href="..&#x2F;modules/cookie.html">cookie</a></li>
            
                <li><a href="..&#x2F;modules/datasource.html">datasource</a></li>
            
                <li><a href="..&#x2F;modules/deferred.html">deferred</a></li>
            
                <li><a href="..&#x2F;modules/escape.html">escape</a></li>
            
                <li><a href="..&#x2F;modules/form.html">form</a></li>
            
                <li><a href="..&#x2F;modules/io.html">io</a></li>
            
                <li><a href="..&#x2F;modules/io-xdr.html">io-xdr</a></li>
            
                <li><a href="..&#x2F;modules/json.html">json</a></li>
            
                <li><a href="..&#x2F;modules/layout.html">layout</a></li>
            
                <li><a href="..&#x2F;modules/log.html">log</a></li>
            
                <li><a href="..&#x2F;modules/menu.html">menu</a></li>
            
                <li><a href="..&#x2F;modules/node-deferred.html">node-deferred</a></li>
            
                <li><a href="..&#x2F;modules/paginator.html">paginator</a></li>
            
                <li><a href="..&#x2F;modules/progressbar.html">progressbar</a></li>
            
                <li><a href="..&#x2F;modules/selector.html">selector</a></li>
            
                <li><a href="..&#x2F;modules/swf.html">swf</a></li>
            
                <li><a href="..&#x2F;modules/touch.html">touch</a></li>
            
                <li><a href="..&#x2F;modules/treeview.html">treeview</a></li>
            
                <li><a href="..&#x2F;modules/widget-form.html">widget-form</a></li>
            
                <li><a href="..&#x2F;modules/widget-parentchild.html">widget-parentchild</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: build\io.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&#x2F;**
 * Handles AJAX, JSONP and XSLT requests
 * @module io
 * @requires deferred
 * 
 * Copyright (c) 2012, Juan Ignacio Dopazo. All rights reserved.
 * Code licensed under the BSD License
 * https:&#x2F;&#x2F;github.com&#x2F;juandopazo&#x2F;jet&#x2F;blob&#x2F;master&#x2F;LICENSE.md
*&#x2F;
jet.add(&#x27;io&#x27;, function ($) {
&quot;use strict&quot;;

			
var win = $.config.win,
	Lang = $.Lang,
	$Object = $.Object;

var XML = &quot;xml&quot;,
XSL = &quot;xsl&quot;,
TYPE_JSON = &quot;json&quot;,
GET = &quot;GET&quot;;

var HAS_AXO = !!win.ActiveXObject;
var HAS_XHR = !!win.XMLHttpRequest;

var newAXO = function (t) {
	return new win.ActiveXObject(t);
};

var hashToURI = function (hash) {
	var result = [];
	$Object.each(hash, function (key, value) {
		result.push(key + &quot;=&quot; + value);
	});
	return result.join(&quot;&amp;&quot;);
};

var getActiveXParser = function (type) {
	var freeThreadedDOM = &quot;Msxml2.FreeThreadedDOMDocument.&quot;,
		domDocument = &quot;Msxml2.DOMDocument.&quot;,
		test,
	&#x2F;* La eleccion de versiones 6.0 y 3.0 es adrede.
	   La version 4.0 es especifica de windows 2000 y la 5.0 viene unicamente con Microsoft Office
	   La version 6 viene con Windows Vista y uno de los service pack de XP, por lo que el usuario quizas no la tenga
	   Se la usa porque es considerablemente mas rapida *&#x2F;
		v6 = &quot;6.0&quot;,
		v3 = &quot;3.0&quot;;
	try {
		test = newAXO(domDocument + v6);
		getActiveXParser = function (type) {
			if (type == XSL) {
				return newAXO(freeThreadedDOM + v6);
			} else {
				return newAXO(domDocument + v6);
			}
		};
	} catch (e) {
		try {
			test = newAXO(domDocument + v3);
			getActiveXParser = function (type) {
				if (type == XSL) {
					return newAXO(freeThreadedDOM + v3);
				} else {
					return newAXO(domDocument + v3);
				}
			};
		} catch (ex) {
			
		}
	}
	return getActiveXParser(type);
},

getAjaxObject = function () {
	var hostname = location.host,
		msxml = &quot;Microsoft.XMLHTTP&quot;,
		test;
	if (HAS_AXO &amp;&amp; (!HAS_XHR || (location.protocol == &quot;file:&quot; || hostname == &quot;localhost&quot; || hostname == &quot;127.0.0.1&quot;))) {
		getAjaxObject = function () {
			return newAXO(msxml);
		};
	} else {
		getAjaxObject = function () {
			return new XMLHttpRequest();
		};
	}
	return getAjaxObject();
};

var timeoutError = &quot;timeout&quot;,
noObjectError = &quot;Can&#x27;t create object&quot;,
noStatusError = &quot;Bad status&quot;,
notFoundError = &quot;File not found&quot;;

&#x2F;* Parsea un XML
En Internet Explorer instancia un objeto ActiveX llamado MSXML. En el resto usa XMLHttpRequest.responseXML *&#x2F;
var parseXML = function (xmlFile, type, errorHandler) {
	var xmlDoc = null;
	if (xmlFile.responseXML) {
		xmlDoc = xmlFile.responseXML;
	} else if (win.DOMParser) {
		xmlDoc = new win.DOMParser();
		xmlDoc = xmlDoc.parseFromString(xmlFile.responseText || xmlFile, &quot;text&#x2F;xml&quot;);
	} else if (HAS_AXO) {
		xmlDoc = getActiveXParser(type);
		xmlDoc.async = false;
		xmlDoc.loadXML(xmlFile.responseText || xmlFile);
		if (xmlDoc.parseError.errorCode !== 0) {
			errorHandler(noStatusError, xmlDoc.parseError);
		}
	} else {
		errorHandler(0, {
			reason: &quot;Can&#x27;t find a suitable XML parser&quot;,
			srcText: xmlFile
		});
	}
	return xmlDoc;
};
			
var getResultByContentType = function (xhr, dataType, onError) {
	var contentType = dataType || xhr.getResponseHeader(&#x27;Content-type&#x27;);
	switch (contentType) {
	case &#x27;application&#x2F;xml&#x27;:
	case XML:
	case XSL:
		return parseXML(xhr, contentType, onError);
	case TYPE_JSON:
		try {
			return $.JSON.parse(xhr.responseText);
		} catch (e) {
			$.error(e);
		}
		break;
	default:					
		return xhr.responseText;
	}
};


&#x2F;**
 * Handles AJAX and JSONP requests
 * @class IO
 * @static
 *&#x2F;
&#x2F;**
 * Makes an ajax request
 * @method ajax
 * @param {Object} settings
 *&#x2F;
function ajax(url, settings) {
	var self = this;
	var xhr = getAjaxObject();
   
	var result = null;
	
	var dataType		= settings.dataType;
	var timeout			= settings.timeout || 10000; &#x2F;* Tiempo que tarda en cancelarse la transaccion *&#x2F;
	var method			= settings.method || &quot;GET&quot;; &#x2F;* Metodo para enviar informacion al servidor *&#x2F;
	var async			= settings.async || true;
	var on				= settings.on || {};
	var complete		= on.complete || function () {};
	var success			= on.success;
	var onSuccess		= function () {
		if (success) {
			success.apply(self, arguments);
		}
		complete.apply(self, arguments);
	};
	var onError			= function (a, b, c) {
		if (on.failure) {
			on.failure(a, b, c);
		}
		complete.apply(self, arguments);
	};

	if (xhr) {
		&#x2F;* Esto corrije el problema de ausencia de tipos mime solo si existe el metodo overrideMimeType (no existe en IE) *&#x2F;
		if (dataType &amp;&amp; (dataType === XML || dataType === XSL) &amp;&amp; xhr.overrideMimeType) {
			xhr.overrideMimeType(&#x27;text&#x2F;xml&#x27;);
		}
		if (url) {
			if (url.substr(url.length - 1) != &quot;?&quot;) {
				url += &quot;?&quot;;
			}
			if (settings.data) {
				url += hashToURI(settings.data);
			}
			if (async === true) {
				xhr.onreadystatechange = function () {
					if (xhr.readyState === 4) {
						&#x2F;* Normalmente deberia chequearse unicamente el status == 200, pero cuando se hace una transaccion local el status en IE termina siendo 0
						 por lo que con revisar que exista la respuesta alcanza *&#x2F;
						if (xhr.status === 404) {
							onError(notFoundError, xhr.status, xhr);
						} else if (xhr.status === 408) {
							onError(timeoutError, xhr.status, xhr);
						} else if (xhr.status === 200 || xhr.responseText || xhr.responseXML) { 
							onSuccess(getResultByContentType(xhr, dataType, onError), xhr);
						} else {
							onError(noStatusError, xhr.status, xhr); 
						}
					}
				};
			}
			&#x2F;* Cuando la transaccion se hace en un filesystem local y el archivo de destino no existe,
			   no se llega a pasar por el evento onreadystatechange sino que puede lanzar una excepcion en algunos navegadores *&#x2F;
			try {
				xhr.open(method, url, async);
				xhr.send(null);
			} catch (e) {
				onError(noStatusError, 404, xhr); 
			}
			if (async === false) {
				result = getResultByContentType(xhr, dataType, onError);
			} else {
				setTimeout(function () {
					if (xhr.readyState !== 4) {
						xhr.abort();
						onError(timeoutError, 408, xhr);
					}
				}, timeout);
			}
		}
	}
	return result || $;
}
var ioNS = jet.namespace(&#x27;IO&#x27;);
if (!ioNS.jsonpCallbacks) {
	ioNS.jsonpCallbacks = [];
}

function jsonp(url, settings) {
	settings = settings || {};
	var jsonCallbackParam = settings.jsonCallbackParam || &quot;p&quot;;
	var success = function (result) {
		if (settings.success) {
			settings.success(result);
		}
		if (settings.complete) {
			settings.complete(result);
		}
	};
	var error = function (result) {
		if (settings.failure) {
			settings.failure(result);
		}
		if (settings.complete) {
			settings.complete(result);
		}
	};
	var callbacks = ioNS.jsonpCallbacks;
	var index = callbacks.length;
	var loaded = false;
	if (url) {
		callbacks[index] = function (data) {
			loaded = true;
			success(data);
		};
		if (url.substr(url.length - 1) != &quot;?&quot;) {
			url += &quot;?&quot;;
		}
		if (!settings.data) {
			settings.data = {};
		}
		settings.data[jsonCallbackParam] = &quot;jet.IO.jsonpCallbacks[&quot; + index + &quot;]&quot;;
		
		&#x2F;&#x2F;Added a timeout of 0 as suggested by Google in 
		&#x2F;&#x2F;http:&#x2F;&#x2F;googlecode.blogspot.com&#x2F;2010&#x2F;11&#x2F;instant-previews-under-hood.html
		setTimeout(function () {
			$.Get.script(url + hashToURI(settings.data));
		}, 0);
		setTimeout(function () {
			if (!loaded) {
				error({
					message: &quot;Request failed&quot;,
					reason: &quot;Timeout&quot;
				});
			}
		}, settings.timeout || 10000);
	}
};
var transform = function (xml, xsl, parameters) {
	parameters = parameters || {};
	if (win.XSLTProcessor) {
		transform = function (xml, xsl, parameters) {
			var xsltProcessor = new window.XSLTProcessor(),
				intnode,
				paramName;
			xsltProcessor.importStylesheet(xsl);
			for (paramName in parameters) {
				if (parameters.hasOwnProperty(paramName)) {
					xsltProcessor.setParameter(null, paramName, parameters[paramName]);
				}
			}
			return $(xsltProcessor.transformToFragment(xml, $.config.doc));
		};
	} else if (win.ActiveXObject) {
		transform = function (xml, xsl, parameters) {
			var xsltThread = new window.ActiveXObject(&quot;Msxml2.XSLTemplate.6.0&quot;),
				xsltProc,
				paramName;
			xsltThread.stylesheet = xsl;
			xsltProc = xsltThread.createProcessor();
			xsltProc.input = xml;
			for (paramName in parameters) {
				if (parameters.hasOwnProperty(paramName)) {
					xsltProc.addParameter(paramName, parameters[paramName]);
				}
			}
			xsltProc.transform();
			return $(xsltProc.output);
		};
	}
	return transform(xml, xsl, parameters);
};
	
&#x2F;**
 * @method xsl
 * @description Makes a XSL transformation. Loads the files with Ajax if needed. &lt;strong&gt;Requires the io-xsl submodule&lt;&#x2F;strong&gt;
 * @param {Object} settings
 *&#x2F;
function xslt(xml, xsl, settings) {
	var parameters = settings.params;
	var xmlDoc, xslDoc;
	
	var success = function (data) {
		if (settings.success) {
			settings.success(data);
		}
		if (settings.complete) {
			settings.complete(data);
		}
	};
	var error = function (data) {
		if (settings.failure) {
			settings.failure(data);
		}
		if (settings.complete) {
			settings.complete(data);
		}
	};
	
	var checkReady = function () {
		if (xmlDoc &amp;&amp; xslDoc) {
			success(transform(xmlDoc, xslDoc, parameters));
		}
	};
	if (Lang.isString(xml) || Lang.isString(xsl)) {
		if (Lang.isString(xml)) {
			$.ajax({
				url: xml,
				dataType: &#x27;xml&#x27;,
				success: function (result) {
					xmlDoc = result;
					checkReady();
				},
				error: error
			});
		} else {
			xmlDoc = xml;
		}
		if (Lang.isString(xsl)) {
			$.ajax({
				url: xsl,
				dataType: &#x27;xsl&#x27;,
				success: function (result) {
					xslDoc = result;
					checkReady();
				},
				error: error
			});
		} else {
			xslDoc = xsl;
		}
	} else {
		xmlDoc = xml;
		xslDoc = xml;
		checkReady();
	}
};&#x2F;**
 * Represents the promise of an IO request being completed.
 * Can also be aborted
 * @class Request
 * @constructor
 * @extends Promise
 *&#x2F;
function Request() {
	Request.superclass.constructor.apply(this, arguments);
}
$.extend(Request, $.Promise, {
	
	&#x2F;**
	 * @method abort
	 * @description Aborts the request if available (doesn&#x27;t work on JSONP requests)
	 * @chainable
	 *&#x2F;
	abort: function () {
		if (this._request &amp;&amp; this._request.abort) {
			this._request.abort();
		}
		return this.reject();
	}
	
	&#x2F;**
	 * @method ajax
	 * @description Calls $.ajax and returns a new Request
	 * @param {String} url The url for the io request
	 * @param {Object} config Config options for the io request (see $.io)
	 * @return Request
	 *&#x2F;
	
	&#x2F;**
	 * @method jsonp
	 * @description Calls $.jsonp and returns a new Request
	 * @param {String} url The url for the jsonp request
	 * @param {Object} config Config options for the jsonp request (see $.io)
	 * @return Request
	 *&#x2F;
	
}, {
	
	addMethod: function (name, fn) {
		Request.prototype[name] = function (url, opts) {
			var config = (!Lang.isObject(opts) || Lang.isFunction(opts)) ? {} : opts,
				on = config.on || (config.on = {}),
				success = on.success,
				failure = on.failure;
			if (Lang.isFunction(opts)) {
				success = opts;
			}
			return this.defer(function (promise) {
				on.success = $.bind(promise.resolve, promise);
				on.failure = $.bind(promise.reject, promise);
				this._request = fn(url, config);
			}).then(success, failure);
		};
	}
	
});

$.Request = Request;

var TRANSACTION_METHODS = {
	ajax: ajax,
	jsonp: jsonp,
	xslt: xslt
};

$Object.each(TRANSACTION_METHODS, Request.addMethod);

$Object.each(TRANSACTION_METHODS, function (name, fn) {
	$[name] = function () {
		var request = new $.Request();
		fn.apply(request, arguments);
		return request;
	};
});
			
});

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
