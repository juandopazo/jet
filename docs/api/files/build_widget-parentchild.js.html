<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>build\widget-parentchild.js - Jet</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.5.0pr4&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.5.0pr4&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title="Jet"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.1.2</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/$.html">$</a></li>
            
                <li><a href="..&#x2F;classes/Button.html">Button</a></li>
            
                <li><a href="..&#x2F;classes/ButtonGroup.html">ButtonGroup</a></li>
            
                <li><a href="..&#x2F;classes/CheckBox.html">CheckBox</a></li>
            
                <li><a href="..&#x2F;classes/Cookie.html">Cookie</a></li>
            
                <li><a href="..&#x2F;classes/DataSource.html">DataSource</a></li>
            
                <li><a href="..&#x2F;classes/DataSource.Ajax.html">DataSource.Ajax</a></li>
            
                <li><a href="..&#x2F;classes/DataSource.Get.html">DataSource.Get</a></li>
            
                <li><a href="..&#x2F;classes/DataSource.Local.html">DataSource.Local</a></li>
            
                <li><a href="..&#x2F;classes/DataSource.XDR.html">DataSource.XDR</a></li>
            
                <li><a href="..&#x2F;classes/Escape.html">Escape</a></li>
            
                <li><a href="..&#x2F;classes/FieldSet.html">FieldSet</a></li>
            
                <li><a href="..&#x2F;classes/Form.html">Form</a></li>
            
                <li><a href="..&#x2F;classes/FormField.html">FormField</a></li>
            
                <li><a href="..&#x2F;classes/IO.html">IO</a></li>
            
                <li><a href="..&#x2F;classes/JSON.html">JSON</a></li>
            
                <li><a href="..&#x2F;classes/Layout.html">Layout</a></li>
            
                <li><a href="..&#x2F;classes/LayoutPanel.html">LayoutPanel</a></li>
            
                <li><a href="..&#x2F;classes/LayoutPanelBase.html">LayoutPanelBase</a></li>
            
                <li><a href="..&#x2F;classes/Log.html">Log</a></li>
            
                <li><a href="..&#x2F;classes/Paginator.html">Paginator</a></li>
            
                <li><a href="..&#x2F;classes/ProgressBar.html">ProgressBar</a></li>
            
                <li><a href="..&#x2F;classes/Promise.html">Promise</a></li>
            
                <li><a href="..&#x2F;classes/RadioButton.html">RadioButton</a></li>
            
                <li><a href="..&#x2F;classes/RadioGroup.html">RadioGroup</a></li>
            
                <li><a href="..&#x2F;classes/Record.html">Record</a></li>
            
                <li><a href="..&#x2F;classes/RecordSet.html">RecordSet</a></li>
            
                <li><a href="..&#x2F;classes/SelectField.html">SelectField</a></li>
            
                <li><a href="..&#x2F;classes/SWF.html">SWF</a></li>
            
                <li><a href="..&#x2F;classes/ToggleButton.html">ToggleButton</a></li>
            
                <li><a href="..&#x2F;classes/TreeNode.html">TreeNode</a></li>
            
                <li><a href="..&#x2F;classes/TreeView.html">TreeView</a></li>
            
                <li><a href="..&#x2F;classes/WidgetChild.html">WidgetChild</a></li>
            
                <li><a href="..&#x2F;classes/WidgetParent.html">WidgetParent</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="..&#x2F;modules/array-extras.html">array-extras</a></li>
            
                <li><a href="..&#x2F;modules/button.html">button</a></li>
            
                <li><a href="..&#x2F;modules/cookie.html">cookie</a></li>
            
                <li><a href="..&#x2F;modules/datasource.html">datasource</a></li>
            
                <li><a href="..&#x2F;modules/deferred.html">deferred</a></li>
            
                <li><a href="..&#x2F;modules/escape.html">escape</a></li>
            
                <li><a href="..&#x2F;modules/form.html">form</a></li>
            
                <li><a href="..&#x2F;modules/io.html">io</a></li>
            
                <li><a href="..&#x2F;modules/io-xdr.html">io-xdr</a></li>
            
                <li><a href="..&#x2F;modules/json.html">json</a></li>
            
                <li><a href="..&#x2F;modules/layout.html">layout</a></li>
            
                <li><a href="..&#x2F;modules/log.html">log</a></li>
            
                <li><a href="..&#x2F;modules/menu.html">menu</a></li>
            
                <li><a href="..&#x2F;modules/node-deferred.html">node-deferred</a></li>
            
                <li><a href="..&#x2F;modules/paginator.html">paginator</a></li>
            
                <li><a href="..&#x2F;modules/progressbar.html">progressbar</a></li>
            
                <li><a href="..&#x2F;modules/selector.html">selector</a></li>
            
                <li><a href="..&#x2F;modules/swf.html">swf</a></li>
            
                <li><a href="..&#x2F;modules/touch.html">touch</a></li>
            
                <li><a href="..&#x2F;modules/treeview.html">treeview</a></li>
            
                <li><a href="..&#x2F;modules/widget-form.html">widget-form</a></li>
            
                <li><a href="..&#x2F;modules/widget-parentchild.html">widget-parentchild</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: build\widget-parentchild.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&#x2F;**
 * A module declaring extensions for parent&#x2F;child relationships between nodes
 * @module widget-parentchild
 * @requires base
 * 
 * Copyright (c) 2012, Juan Ignacio Dopazo. All rights reserved.
 * Code licensed under the BSD License
 * https:&#x2F;&#x2F;github.com&#x2F;juandopazo&#x2F;jet&#x2F;blob&#x2F;master&#x2F;LICENSE.md
*&#x2F;
jet.add(&#x27;widget-parentchild&#x27;, function ($) {
&quot;use strict&quot;;

			
var Lang = $.Lang,
	Widget = $.Widget;
	
var SELECTED = &#x27;selected&#x27;,
	SELECTED_INDEX = &#x27;selectedIndex&#x27;,
	SELECT = &#x27;select&#x27;,
	BOUNDING_BOX = &#x27;boundingBox&#x27;,
	CONTENT_BOX = &#x27;contentBox&#x27;,
	INDEX = &#x27;index&#x27;,
	CHANGE = &#x27;Change&#x27;,
	CHILDREN = &#x27;children&#x27;,
	CLASS_PREFIX = &#x27;classPrefix&#x27;,
	CLASS_NAME = &#x27;className&#x27;,
	MULTIPLE = &#x27;multiple&#x27;,
	SELECTION = &#x27;selection&#x27;,
	PARENT = &#x27;parent&#x27;;

&#x2F;**
 * A widget extension that makes the current widget contein child widgets
 * @class WidgetParent
 * @uses ArrayList
 * @constructor
 * @param {Object} config Object literal specifying widget configuration properties
 *&#x2F;
function WidgetParent(config) {
	config = config || {};
	var multiple = this.get(MULTIPLE),
		selection = multiple ? [] : null;
		
	$.ArrayList.call(this);
	
	this._childrenContainer = this.get(&#x27;contentBox&#x27;);
	
	this.on(&#x27;render&#x27;, this._renderChildren);
	this.after(&#x27;selectionChange&#x27;, this._onSelectionChange);
	
	this.after(&#x27;initializedChange&#x27;, function() {
		this._addChildrenFromMarkup();
		this.add(config.children || []);

		this.forEach(function (child) {
			if (child.get(SELECTED)) {
				if (multiple) {
					selection.push(child);
				} else {
					selection = child;
				}
			}
		});
		if (selection) {
			this.set(SELECTION, selection);
		} else {
			this.set(SELECTED_INDEX, 0);
		}
	});
}
$.mix(WidgetParent, {
	
	ATTRS: {
			
		&#x2F;**
		 * @attribute childType
		 * @description Constructor reference to the default type of the children managed by this Widget. The default value is taken from defaultChildType
		 *&#x2F;
		childType: {
			getter: function (val) {
				if (!val) {
					val = this.get(&#x27;defaultChildType&#x27;);
				}
				return Lang.isString(val) ? $[val] : val;
			}
		},
		&#x2F;**
		 * @attribute defaultChildType
		 * @description default value used when a childType is not provided. This attribute is used mostly by classes using WidgetParent.
		 * @default WidgetChild
		 *&#x2F;
		defaultChildType: {
			value: &#x27;Widget&#x27;
		},
		
		&#x2F;**
		 * @attribute children
		 * @description An array of instances or configuration objects representing the widget&#x27;s children
		 * @type Array
		 * @default []
		 *&#x2F;
		children: {
			readOnly: true,
			getter: function () {
				return this._items;
			}
		},
		
		&#x2F;**
		 * @attribute selection
		 * @description Returns the currently selected child Widget. If the mulitple attribte is set to true will return an Y.ArrayList instance containing the currently selected children. If no children are selected, will return null
		 * @default null
		 * @type Widget|Array
		 *&#x2F;
		selection: {
			value: null
		},
		
		&#x2F;**
		 * @attribute multiple
		 * @description Boolean indicating if multiple children can be selected at once. Whether or not multiple selection is enabled is always delegated to the value of the multiple attribute of the root widget in the object hierarchy
		 * @default false
		 *&#x2F;
		multiple: {
			value: false,
			wriceOnce: true
		},
		
		&#x2F;**
		 * @attribute selectedIndex
		 * @description The index of the currently selected item
		 * @type Number
		 *&#x2F;
		selectedIndex: {
			validator: function (val) {
				return Lang.isNumber(val) &amp;&amp; !!this.item(val);
			},
			setter: function (val) {
				var child = this.item(val);
				if (child &amp;&amp; child.select) {
					child.select();
				}
				return val;
			},
			getter: function () {
				var selection = this.get(SELECTION); 
				return selection ? selection.get(INDEX) : -1;
			}
		}
	}
	
});
WidgetParent.prototype = {
	
	_addChildrenFromMarkup: function () {
		var children = [];
		this._childrenContainer.children().forEach(function (node) {
			children.push({
				boundingBox: node
			});
		});
		this.add(children);
	},
	
	_onSelectionChange: function (e) {
		if (this.get(MULTIPLE)) {
			this.forEach(function(child) {
				child.set(SELECTED, $.Array.indexOf(e.newVal, child) &gt; -1, { src: &#x27;_onSelectionChange&#x27; });
			});
		} else if (e.prevVal) {
			e.prevVal.set(SELECTED, false, { src: &#x27;_onSelectionChange&#x27; });
		}
	},
	
	_renderChildren: function () {
		var container = this._childrenContainer;
		
		this.forEach(function (child) {
			child.render(container);
		});
	},
	
	_onChildSelect: function (e) {
		if (e.src !== &#x27;_onSelectionChange&#x27;) {
			var selection = null;
				
			if (this.get(MULTIPLE)) {
				selection = [];
				this.forEach(function (child) {
					if (child.get(SELECTED)) {
						selection.push(child);
					}
				});
			} else if (e.newVal) {
				selection = e.target;
			}
			this.set(SELECTION, selection);
		}
	},
	
	_unHookChild: function (e) {
		var child = e.target.get(INDEX);
		this.splice(child, 1);
		this.forEach(function (item, i) {
			if (i &gt;= child) {
				item.set(INDEX, i);
			}
		});
	},
	
	_add: function (child, index) {
		var ChildType = child.type || this.get(&#x27;childType&#x27;);
		if (Lang.isString(ChildType)) {
			ChildType = $[ChildType];
		}
		
		if (child &amp;&amp; this.fire(&#x27;addChild&#x27;, { child: child, index: index })) {
			
			if (!$.instanceOf(child, $.Widget)) {
				child.parent = this;
				child.index = index;
				child = new (ChildType)(child);
			} else {
				child.set(PARENT, this);
			}
			
			this.splice(index, 0, child);
			if (this.get(&#x27;rendered&#x27;)) {
				child.render(this._childrenContainer);
			}
			
			child.after(&#x27;selectedChange&#x27;, this._onChildSelect, this);
			child.on(&#x27;destroy&#x27;, this._unHookChild, this);
			
			this.fire(&#x27;afterAddChild&#x27;, { child: child, index: index });
		}
		return child;
	},
	
	&#x2F;**
	 * @method addChild
	 * @description Adds a Widget as a child. If the specified Widget already has a parent it will be removed from its current parent before being added as a child
	 * @param child &lt;Widget|Object&gt; The Widget instance, or configuration object for the Widget to be added as a child
	 * @param index &lt;Number&gt; (Optional.) Number representing the position at which the child should be inserted
	 * @return {Widget} child
	 *&#x2F;
	addChild: function(child, index) {
		var result, self = this;
		if (!Lang.isNumber(index)) {
			index = this.size();
		}
		if (Lang.isArray(child)) {
			result = $.Array.map(child, function (c, i) {
				return self._add(c, index + i);
			});
		} else {
			result = this._add(child, index);
		}
		return result;
	},
	
	&#x2F;**
	 * @method add
	 * @description Same as addChild, but chainable
	 * @param child &lt;Widget|Object&gt; The Widget instance, or configuration object for the Widget to be added as a child
	 * @param index &lt;Number&gt; (Optional.) Number representing the position at which the child should be inserted
	 * @chainable
	 *&#x2F;
	add: function (child, index) {
		this.addChild(child, index);
		return this;
	},
	
	&#x2F;**
	 * @method remove
	 * @description Removes a child
	 * @param {WidgetChild|Number} child The child widget or its index
	 * @chainable
	 *&#x2F;
	remove: function (child) {
		if (Lang.isNumber(child)) {
			child = this.item(child);
		}
		if (child &amp;&amp; this.fire(&#x27;removeChild&#x27;, { child: child })) {
			child.destroy();
			this.fire(&#x27;afterRemoveChild&#x27;, { child: child });
		}
		return this;
	},
	
	&#x2F;**
	 * @method first
	 *&#x2F;
	first: function() {
		return this.item(0);
	},
	&#x2F;**
	 * @method last
	 *&#x2F;
	last: function() {
		return this.item(this.size() - 1);
	},
	&#x2F;**
	 * @method removeAll
	 * @chainable
	 *&#x2F;
	removeAll: function () {
		while (this.size() &gt; 0) {
			this.remove(0);
		}
		return this;
	}
	
};

$.mix(WidgetParent.prototype, $.ArrayList.prototype);

&#x2F;**
 * An extension that turns a widget into a child widget
 * @class WidgetChild
 * @constructor
 * @param {Object} config Object literal specifying widget configuration properties
 *&#x2F;
function WidgetChild() {
	this.after(&#x27;selectedChange&#x27;, this._childSelectedChange);
}
$.mix(WidgetChild, {
	
	NAME: &#x27;widget-child&#x27;,
	
	ATTRS: {
		&#x2F;**
		 * @attribute selected
		 * @description Boolean indicating if the Widget is selected
		 * @type Boolean
		 * @default false
		 *&#x2F;
		selected: {
			value: false
		},
		
		&#x2F;**
		 * @attribute index
		 * @description Number representing the Widget&#x27;s ordinal position in its parent Widget
		 * @default 0
		 * @type Number
		 *&#x2F;
		index: {
			value: 0
		},
		
		&#x2F;**
		 * @attribute parent
		 * @description Retrieves the parent of the Widget in the object hierarchy
		 * @default null
		 *&#x2F;
		parent: {
			value: null
		},
		&#x2F;**
		 * @attribute root
		 * @description Retrieves the root parent of the Widget
		 * @readOnly
		 *&#x2F;
		root: {
			readOnly: true,
			valueFn: function () {
				var parent = this.get(PARENT);
				while (parent.get(PARENT)) {
					parent = parent.get(PARENT);
				}
				return parent;
			}
		},
		type: {
			setter: function (val) {
				if (Lang.isString(val)) {
					val = $[val];
				}
				return val;
			}
		}
	},
	
	EVENTS: {
		
		render: function () {
			var self = this;
			var boundingBox = this.get(BOUNDING_BOX);
			if (this.get(SELECTED)) {
				boundingBox.addClass(this.getClassName(SELECTED));
			}
		}
	},
	
	HTML_PARSER: {
		selected: function (boundingBox) {
			return boundingBox.hasClass(this.getClassName(SELECTED));
		}
	}
	
});
WidgetChild.prototype = {
	_childSelectedChange: function (e) {
		this.get(BOUNDING_BOX).toggleClass(this.getClassName(SELECTED), e.newVal);
	},
	&#x2F;**
	 * @method select
	 * @description Selects this widget
	 * @chainable
	 *&#x2F;
	select: function () {
		return this.set(SELECTED, true);
	},
	
	&#x2F;**
	 * @method select
	 * @description Unselects this widget
	 * @chainable
	 *&#x2F;
	unselect: function () {
		return this.set(SELECTED, false);
	},
	
	&#x2F;**
	 * @method toggle
	 * @description Selects&#x2F;unselects this widget
	 * @chainable
	 *&#x2F;
	toggle: function () {
		return this.set(SELECTED, !this.get(SELECTED));
	},
	
	&#x2F;**
	 * @method next
	 * @description Returns the Widget&#x27;s next sibling
	 * @returns Widget Widget instance
	 *&#x2F;
	next: function () {
		return this.get(PARENT).get(CHILDREN)[this.get(INDEX) + 1] || null;
	},
	
	&#x2F;**
	 * @method previous
	 * @description Returns the Widget&#x27;s previous sibling
	 * @returns Widget Widget instance
	 *&#x2F;
	previous: function () {
		return this.get(PARENT).get(CHILDREN)[this.get(INDEX) - 1] || null;
	}
};

$.add({
	WidgetParent: WidgetParent,
	WidgetChild: WidgetChild
});
			
});

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
