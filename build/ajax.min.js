jet().add("ajax",function(g){var j=g.win,d=function(b){return new j.ActiveXObject(b)},i=function(b){var a;try{a=d("Msxml2.DOMDocument.6.0");i=function(e){return e=="xsl"?d("Msxml2.FreeThreadedDOMDocument.6.0"):d("Msxml2.DOMDocument.6.0")}}catch(k){try{a=d("Msxml2.DOMDocument.3.0");i=function(e){return e=="xsl"?d("Msxml2.FreeThreadedDOMDocument.3.0"):d("Msxml2.DOMDocument.3.0")}}catch(l){}}return i(b)},h=function(){var b=location.host;if((location.protocol=="file:"||b=="localhost"||b=="127.0.0.1")&&
j.ActiveXObject)h=function(){return d("Microsoft.XMLHTTP")};else if(XMLHttpRequest)h=function(){return new XMLHttpRequest};else if(j.ActiveXObject)h=function(){return d("Microsoft.XMLHTTP")};return h()};g.ajax=function(){var b=h();return function(a){var k=a.success,l=null;a.timeout=a.timeout||1E4;a.method=a.method||"GET";a.async=a.async||true;a.complete=a.complete||function(){};a.success=function(){k&&k.apply(this,arguments);a.complete.apply(this,arguments)};a.error=function(f,m,c){a.error(f,m,c);
a.complete()};var e=function(){var f=a.dataType||b.getResponseHeader("Content-type");switch(f){case "application/xml":case "xml":case "xsl":var m=a.error,c=null;if(XMLHttpRequest)c=b.responseXML;else{c=i(f);c.async=false;c.loadXML(b.responseText);c.parseError.errorCode!==0&&m("Bad status",c.parseError,b)}return c;case "json":try{return g.JSON.parse(b.responseText)}catch(n){g.error(n)}break;default:return b.responseText}};if(b){if(a.dataType&&(a.dataType==="xml"||a.dataType==="xsl")&&b.overrideMimeType)b.overrideMimeType("text/xml");
if(a.url){if(a.async===true)b.onreadystatechange=function(){if(b.readyState===4)if(b.status===200||b.responseText||b.responseXML)a.success(e(),b);else b.status===408?a.error("timeout",b.status,b):a.error("Bad status",b.status,b)};try{b.open(a.method,a.url,a.async);b.send(null)}catch(o){a.error("Bad status",404,b)}if(a.async===false)l=e();else setTimeout(function(){var f=a.error;if(b.readyState!==4){b.abort();f("timeout",408,b)}},a.timeout)}}return l||g}}()});
