/**
 * @module treeview
 * @requires base,widget-parentchild
 * 
 * Copyright (c) 2011, Juan Ignacio Dopazo. All rights reserved.
 * Code licensed under the BSD License
 * https://github.com/juandopazo/jet/blob/master/LICENSE.md
*/
jet.add("treeview",function(b){var g=b.Lang,e=b.Base,f=b.Widget;b.TreeNode=e.create("treenode",f,[b.WidgetParent,b.WidgetChild],{ATTRS:{type:{value:"text"},title:{value:""},labelContent:{value:""},controlNode:{setter:b},labelNode:{setter:b},defaultChildType:{value:"TreeNode"}},HTML_PARSER:{labelNode:function(){},controlNode:function(){}}},{LABEL_TEMPLATE:"<span/>",CONTROL_TEMPLATE:"<span/>",_uiTNLabelChange:function(a){var c=this.get("labelNode");g.isString(a.newVal)?c.html(a.newVal):c.append(a.newVal)},
_uiTNTitleChange:function(a){this.get("controlNode").attr("title",a.newVal)},_uiTNSelectedChange:function(a){this._expandedChange.call(this,a.newVal,a.oldVal)},_uiTNClick:function(a){a.domEvent.target==this.get("labelNode")&&this.set("selected",!this.get("selected"))},initializer:function(){this.set("labelNode",this.LABEL_TEMPLATE);this.set("controlNode",this.CONTROL_TEMPLATE)},renderUI:function(a){this.get("contentBox");var c=this.get("labelNode").html(this.get("label")).addClass(this.getClassName("label")),
d=this.get("controlNode").addClass(this.getClassName("control"));c.prependTo(a);d.prependTo(a)},bindUI:function(){this._handlers.push(this.get("labelNode").link(this.get("controlNode")).on("click",b.bind(this.toggle,this)));this.after("labelContentChange",this._uiTNLabelChange);this.after("titleChange",this._uiTNTitleChange);this.after("selectedChange",this._uiTNSelectedChange);this.on("click",this._uiTNClick)},syncUI:function(){var a=this.get("title"),c=this.get("selected");a&&this.get("controlNode").attr("title",
a);this.get("children").length>0&&this.get("labelNode").addClass(this.getClassName("label","selectable"));this._expandedChange(c,c)},_expandedChange:function(a,c){this.get("boundingBox");var d=c?"collapse":"expand",h=this.get("controlNode"),i=this.get("contentBox"),j=this.getClassName("control","expanded"),k=this.getClassName("control","collapsed"),l=this.getClassName("content","expanded"),m=this.getClassName("content","collapsed");if(this.get("children").length>0&&this.fire(d)&&this.get("root").fire("node:"+
d,this)){h.toggleClass(j,a).toggleClass(k,!a);i.toggleClass(l,a).toggleClass(m,!a)}}});b.TreeView=e.create("treeview",f,[b.WidgetParent],{ATTRS:{defaultChildType:{value:"TreeNode"}}},{})});
