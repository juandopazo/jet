/**
 * @module treeview
 * @requires base,selector,widget-parentchild
 * 
 * Copyright (c) 2011, Juan Ignacio Dopazo. All rights reserved.
 * Code licensed under the BSD License
 * https://github.com/juandopazo/jet/blob/master/LICENSE.md
*/
jet.add("treeview",function(b){var f=b.Lang,d=b.Widget.getClassName,g=d("treenode","control"),h=d("treenode","control","collapsed"),i=d("treenode","control","expanded");b.TreeNode=b.Base.create("treenode",b.Widget,[b.WidgetParent,b.WidgetChild],{ATTRS:{type:{value:"text"},title:{value:""},label:{valueFn:function(){return this.get("labelNode").attr("innerHTML")}},controlNode:{setter:b},labelNode:{setter:b},defaultChildType:{value:"TreeNode"},multiple:{value:true,readOnly:true}},HTML_PARSER:{contentBox:"> ."+
d("treenode","content"),labelNode:"> ."+d("treenode","label"),controlNode:"> ."+d("treenode","control")}},{LABEL_TEMPLATE:"<span/>",CONTROL_TEMPLATE:"<span/>",_uiTNLabelChange:function(a){var c=this.get("labelNode");f.isString(a.newVal)?c.html(a.newVal):c.append(a.newVal)},_uiTNTitleChange:function(a){this.get("controlNode").attr("title",a.newVal)},_uiTNClick:function(){this.set("selected",!this.get("selected"))},initializer:function(){this.get("labelNode")||this.set("labelNode",this.LABEL_TEMPLATE);
this.get("controlNode")||this.set("controlNode",this.CONTROL_TEMPLATE);this.after("labelChange",this._uiTNLabelChange);this.after("titleChange",this._uiTNTitleChange);this.after("selectedChange",this._uiTNSelectedChange);this.after("selectableChange",this._tnToggleSelectable)},renderUI:function(a){this.get("contentBox");var c=this.get("labelNode").html(this.get("label")).addClass(this.getClassName("label")),e=this.get("controlNode").addClass(g);c.prependTo(a);e.prependTo(a)},bindUI:function(){this._handlers.push(this.get("labelNode").on("click",
this._uiTNClick,this),this.get("controlNode").on("click",this._uiTNClick,this))},syncUI:function(){var a=this.get("title"),c=this.get("selected");a&&this.get("controlNode").attr("title",a);this._uiTNSelectedChange({newVal:c,prevVal:c})},_uiTNSelectedChange:function(a){var c=a.newVal;this.get("boundingBox");a=a.prevVal?"collapse":"expand";var e=this.get("controlNode"),j=this.get("contentBox"),k=this.getClassName("content","expanded"),l=this.getClassName("content","collapsed");if(this.size()>0&&this.fire(a)&&
this.get("root").fire("node:"+a,this)){e.toggleClass(i,c).toggleClass(h,!c);j.toggleClass(k,c).toggleClass(l,!c)}}});b.TreeView=b.Base.create("treeview",b.Widget,[b.WidgetParent],{ATTRS:{defaultChildType:{value:"TreeNode"},multiple:{value:true,readOnly:true}}},{})});
