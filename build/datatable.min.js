jet().add("datatable",function(e){var h=e.Lang,m=e.Array;if(!jet.DataTable)jet.DataTable={};if(!h.isNumber(jet.DataTable.ids))jet.DataTable.ids=0;var n=function(){n.superclass.constructor.apply(this,arguments);var b=this.addAttrs({dataSource:{required:true},columnDefinitions:{required:true,validator:h.isArray},className:{writeOnce:true,value:"dt"}}),o=jet.DataTable.ids++,k=b.get("dataSource").get("recordSet"),p=b.get("classPrefix"),q=b.get("className"),d=p+q+"-",j=d+o+"rec",r=d+o+"th-",s=e("<table/>").attr("id",
d+o),v=e("<thead/>").appendTo(s),i=e("<tbody/>").addClass(d+"data").appendTo(s),l,u=function(a){var c,f,g,t=a.attr("id").split("-").pop();if(a.hasClass(d+"desc")){c="asc";f="desc"}else{f="asc";c="desc"}v.find("th").removeClass(d+c,d+f);a.addClass(d+c).removeClass(d+f);k.sortBy(t,c);l=t;a=k.getRecords();g=a.length;var w,x;c=d+(g%2===0?"even":"odd");f=d+(g%2===0?"odd":"even");e("#"+j+a[g-1].getId()).addClass(g%2===0?f:c).removeClass(g%2===0?c:f);for(g=g-2;g>=0;g--){w=e("#"+j+a[g].getId());x=e("#"+j+
a[g+1].getId());w.addClass(g%2===0?c:f).removeClass(g%2===0?f:c).insertBefore(x)}i.find("."+d+"desc").removeClass(d+"desc");i.find("."+d+"col-"+t).addClass(d+"desc")},y=b.get("columnDefinitions");m.each(y,function(a,c){var f=e("<th/>").append(e("<div/>").addClass(d+"liner").append(e("<span/>").addClass(d+"label").html(a.label||a.key)));f.attr("id",r+a.key);if(c===0)f.addClass(d+"first");else c==y.length-1&&f.addClass(d+"last");a.sortable&&f.addClass(d+"sortable").on("click",function(g){g.stopPropagation();
g.preventDefault();u(f)});v.append(f)});var z=function(a){h.isRecord(a)||(a=new e.Record(a));var c=e("<tr/>").attr("id",j+a.getId());m.each(b.get("columnDefinitions"),function(f){c.append(e("<td/>").addClass(p+q+"-col-"+f.key).append(e("<div/>").addClass(d+"liner").html(a.get(f.key))))});c.addClass(i.children()._nodes.length%2===0?d+"even":d+"odd").appendTo(i)};b.addRow=function(a){z(a);l&&u(e("#"+r+l))};b.addRows=function(a){if(h.isArray(a))m.each(a,function(c){h.isRecord(c)||new e.Record(c)});else if(h.isRecordSet(a))a=
a.getRecords();m.each(a,z);l&&u(e("#"+r+l))};b.deleteRow=function(){};b.deleteRows=function(){};b.getColumn=function(){};b.getFirstTr=function(){return i.children().eq(0)};b.getNextTr=function(a){if(h.isRecord(a))a=a.getId();if(h.isNumber(a))a=i.find("#"+j+a);return a.next()};b.getFirstTd=function(a){if(h.isRecord(a))a=a.getId();if(h.isNumber(a))a=i.find("#"+j+a);return a.children().eq(0)};b.getNextTd=function(a){return a.next()};b.getSelectedCell=function(){};b.getSelectedRow=function(){};b.getSelectedColumn=
function(){};b.selectCell=function(){};b.selectRow=function(){};b.selectColumn=function(){};b.unselectCell=function(){};b.unselectRow=function(){};b.unselectColumn=function(){};b.unselectAll=function(){};b.onDataReturnReplaceRows=function(a,c){i.children().remove();b.addRows(c);k.replace(c)};b.onDataReturnAddRows=function(a,c){b.addRows(c);k.push(c)};b.on("render",function(){b.onDataReturnAddRows(null,k);b.get("boundingBox").addClass(p+q).append(s)})};e.extend(n,e.Widget);e.add({DataTable:n})});
