/*
 Copyright (c) 2010, Juan Ignacio Dopazo. All rights reserved.
 Code licensed under the BSD License
 http://code.google.com/p/jet-js/wiki/Licence
*/
jet().add("container",function(d){var i=d.Lang,w=d.Hash,r=d.Array,p=d.DOM,q=!d.UA.ie||d.UA.ie<8,l=function(){l.superclass.constructor.apply(this,arguments);var a=this,h={},f=function(b){return function(e){var c=h[b];c||(c=d("<div/>"));c.children().remove();i.isString(e)?c.html(e):c.append(e);return h[b]=c}};a.addAttrs({header:{setter:f("header"),validator:i.isValue},body:{value:"",setter:f("body"),validator:i.isValue},footer:{setter:f("footer"),validator:i.isValue}});a.set("className",l.NAME);a.on("render",
function(){var b=a.get("boundingBox");w.each(h,function(e,c){c.addClass(e).appendTo(b)})})};l.NAME="module";d.extend(l,d.Widget);var m=function(){m.superclass.constructor.apply(this,arguments);var a=this.addAttrs({center:{value:true},fixed:{value:false},width:{value:300,validator:i.isNumber},height:{value:0,validator:i.isNumber},top:{validator:i.isNumber,setter:function(b){a.unset("bottom");return b}},left:{validator:i.isNumber,setter:function(b){a.unset("right");return b}},bottom:{validator:i.isNumber,
setter:function(b){a.unset("top");return b}},right:{validator:i.isNumber,setter:function(b){a.unset("left");return b}},draggable:{validator:function(){return!!d.Drag},value:false},zIndex:{value:100},modal:{value:false}});a.set("className",m.NAME);var h=function(b){var e=p.screenSize(),c=a.get("rendered");b.css({left:(e.width-(c?b.width():a.get("width")))/2+"px",top:(e.height-(c?b.height():a.get("height")))/2+"px"})};r.each(["height","width"],function(b){a.on(b+"Change",function(e,c){var g=a.get("boundingBox")[b](c);
a.get("center")&&h(g)})});var f=function(b){var e=d(d.context.body).currentStyle();r.each(["left","top","bottom","right"],function(c){var g=c.substr(0,1).toUpperCase()+c.substr(1);g=d.pxToFloat(e["padding"+g])+d.pxToFloat(e["margin"+g]);if(q)b.css(c,a.isSet(c)?a.get(c)-g+"px":"auto");else{var j=p.screenSize();if(c=="bottom")b.css("top",a.isSet(c)?j.height-a.get("height")-g+b.scrollTop()+"px":"auto");else c=="right"?b.css("left",a.isSet(c)?j.width-a.get("width")-g+b.scrollLeft()+"px":"auto"):b.css(c,
a.isSet(c)?a.get(c)-g+"px":"auto")}})};a.on("render",function(){var b=d(d.win),e=a.get("boundingBox"),c=a.get("header"),g=a.get("body"),j=a.get("footer"),n=a.get("fixed")&&q?"fixed":"absolute",t=a.get("height"),u=p.screenSize(),s=d("<div/>").css({position:"fixed",top:"0px",left:"0px",background:"#000",visibility:!a.get("modal")?"hidden":"",zIndex:a.get("zIndex")-1,opacity:0.4}).width(u.width).height(u.height).appendTo(d.context.body);b.on("resize",function(){var v=p.screenSize();s.width(v.width).height(v.height)});
a.on("hide",function(){s.hide()}).on("show",function(){a.get("modal")&&s.show()});c&&e.append(c);g&&e.append(g);j&&e.append(j);e.css("position",n).css("zIndex",a.get("zIndex")).width(a.get("width"));t&&e.height(t);f(e)});a.on("afterRender",function(){var b=a.get("boundingBox"),e=d(d.win),c=a.get("header"),g=a.get("fixed");if(a.get("draggable"))a.dd=new d.Drag({node:b,handlers:c});if(a.get("center")){h(b);e.on("resize",function(){h(a.get("boundingBox"))});if(g||!q)d(d.win).on("scroll",function(){h(a.get("boundingBox"))});
a.on("afterShow",function(){h(b)})}else if(g&&!q){e.on("scroll",function(){f(a.get("boundingBox"))});e.on("resize",function(){f(a.get("boundingBox"))})}})};m.NAME="overlay";d.extend(m,l);var k=function(){k.superclass.constructor.apply(this,arguments);var a=this.set("className",k.NAME).addAttrs({contentBox:{readOnly:true,value:d("<div/>")},underlay:{readOnly:true,value:d("<div/>").addClass("underlay")},shadow:{value:true}}).on("heightChange",function(f,b){a.get("contentBox").height(b)}),h=d("<a/>").attr("href",
"#").addClass("container-close").on("click",function(f){a.fire("close")&&a.hide();f.preventDefault()});a.addAttr("close",{value:true,validator:i.isBoolean,setter:function(f){f?h.show():h.hide();return f}}).on("render",function(){var f=a.get("height"),b=a.get("contentBox");f&&b.height(f);f=a.get("classPrefix");for(var e=a.get("boundingBox").addClass(f+k.NAME+"-container"),c=a.get("header"),g=a.get("body"),j=a.get("footer"),n=k;n.NAME;){b.addClass(f+n.NAME);n=n.superclass.constructor}c&&b.append(c.remove(true));
g&&b.append(g.remove(true));j&&b.append(j.remove(true));a.get("close")&&h.appendTo(b);b.appendTo(e).css("visibility","inherit");e.append(a.get("underlay"));a.get("shadow")&&e.addClass("shadow")})};k.NAME="panel";d.extend(k,m);var o=function(){o.superclass.constructor.apply(this,arguments);var a=this;a.addAttrs({footer:{readOnly:true,value:d("<div/>").addClass("footer")},buttons:{validator:i.isArray,value:[]}}).set("className",o.NAME);a.on("render",function(){a.get("boundingBox").addClass(a.get("classPrefix")+
o.NAME);var h=d("<div/>").addClass("button-group");r.each(a.get("buttons"),function(f,b){var e=new d.Button(f);b===0&&e.get("boundingBox").addClass("default");e.on("pressed",function(){a.hide()}).render(h)});a.get("footer").append(h)})};o.NAME="dialog";d.extend(o,k);d.add({Module:l,Overlay:m,Panel:k,SimpleDialog:o})});
