/*
 Copyright (c) 2010, Juan Ignacio Dopazo. All rights reserved.
 Code licensed under the BSD License
 http://code.google.com/p/jet-js/wiki/Licence
*/
jet().add("container",function(c){var j=c.Lang,s=c.Hash,q=c.Array,r=c.DOM,p=!c.UA.ie||c.UA.ie<8,m=function(){m.superclass.constructor.apply(this,arguments);var a=this,h={},f=function(g){return function(b){var e=h[g];e||(e=c("<div/>"));e.children().remove();j.isString(b)?e.html(b):e.append(b);return h[g]=e}};a.addAttrs({header:{setter:f("header"),validator:j.isValue},body:{value:"",setter:f("body"),validator:j.isValue},footer:{setter:f("footer"),validator:j.isValue}});a.set("className",m.NAME);a.on("render",
function(){var g=a.get("boundingBox");s.each(h,function(b,e){e.addClass(b).appendTo(g)})})};m.NAME="module";c.extend(m,c.Widget);var n=function(){n.superclass.constructor.apply(this,arguments);var a=this.addAttrs({center:{value:true},fixed:{value:false},width:{value:300,validator:j.isNumber},height:{value:0,validator:j.isNumber},top:{validator:j.isNumber,setter:function(b){a.unset("bottom");return b}},left:{validator:j.isNumber,setter:function(b){a.unset("right");return b}},bottom:{validator:j.isNumber,
setter:function(b){a.unset("top");return b}},right:{validator:j.isNumber,setter:function(b){a.unset("left");return b}},draggable:{validator:function(){return!!c.Drag},value:false}});a.set("className",n.NAME);var h=false;a.on("rendered",function(){h=true});var f=function(b){var e=r.screenSize();b.css({left:(e.width-(h?b.width():a.get("width")))/2+"px",top:(e.height-(h?b.height():a.get("height")))/2+"px"})};q.each(["height","width"],function(b){a.on(b+"Change",function(e,d){var i=a.get("boundingBox")[b](d);
a.get("center")&&f(i)})});var g=function(b){var e=c(c.context.body).currentStyle();q.each(["left","top","bottom","right"],function(d){var i=d.substr(0,1).toUpperCase()+d.substr(1);i=c.pxToFloat(e["padding"+i])+c.pxToFloat(e["margin"+i]);if(p)b.css(d,a.isSet(d)?a.get(d)-i+"px":"auto");else{var k=r.screenSize();if(d=="bottom")b.css("top",a.isSet(d)?k.height-a.get("height")-i+b.scrollTop()+"px":"auto");else d=="right"?b.css("left",a.isSet(d)?k.width-a.get("width")-i+b.scrollLeft()+"px":"auto"):b.css(d,
a.isSet(d)?a.get(d)-i+"px":"auto")}})};a.on("render",function(){var b=c(c.win),e=a.get("boundingBox"),d=a.get("header");d&&e.append(d);(d=a.get("body"))&&e.append(d);(d=a.get("footer"))&&e.append(d);var i=(d=a.get("fixed"))&&p?"fixed":"absolute",k=a.get("height");e.css("position",i).width(a.get("width"));k&&e.height(k);g(e);if(a.get("center")){f(e);b.on("resize",function(){f(a.get("boundingBox"))});if(d||!p)c(c.win).on("scroll",function(){f(a.get("boundingBox"))})}else if(d&&!p){b.on("scroll",function(){g(a.get("boundingBox"))});
b.on("resize",function(){g(a.get("boundingBox"))})}});a.on("afterRender",function(){if(a.get("draggable")){var b=a.get("header");a.dd=new c.Drag({node:a.get("boundingBox")});b&&a.dd.addHandler(b)}})};n.NAME="overlay";c.extend(n,m);var l=function(){l.superclass.constructor.apply(this,arguments);var a=this.set("className",l.NAME).addAttrs({contentBox:{readOnly:true,value:c("<div/>")},underlay:{readOnly:true,value:c("<div/>").addClass("underlay")},shadow:{value:true}}).on("heightChange",function(f,g){a.get("contentBox").height(g)}),
h=c("<a/>").attr("href","#").addClass("container-close").on("click",function(f){a.fire("close")&&a.hide();f.preventDefault()});a.addAttr("close",{value:true,validator:j.isBoolean,setter:function(f){f?h.show():h.hide();return f}}).on("render",function(){var f=a.get("height"),g=a.get("contentBox");f&&g.height(f);f=a.get("classPrefix");for(var b=a.get("boundingBox").addClass(f+l.NAME+"-container"),e=a.get("header"),d=a.get("body"),i=a.get("footer"),k=l;k.NAME;){g.addClass(f+k.NAME);k=k.superclass.constructor}e&&
g.append(e.remove(true));d&&g.append(d.remove(true));i&&g.append(i.remove(true));a.get("close")&&h.appendTo(g);g.appendTo(b).css("visibility","inherit");b.append(a.get("underlay"));a.get("shadow")&&b.addClass("shadow")})};l.NAME="panel";c.extend(l,n);var o=function(){o.superclass.constructor.apply(this,arguments);var a=this;a.addAttrs({footer:{readOnly:true,value:c("<div/>").addClass("footer")},buttons:{validator:j.isArray,value:[]}}).set("className",o.NAME);a.on("render",function(){a.get("boundingBox").addClass(a.get("classPrefix")+
o.NAME);var h=c("<div/>").addClass("button-group");q.each(a.get("buttons"),function(f,g){var b=new c.Button(f);g===0&&b.get("boundingBox").addClass("default");b.on("pressed",function(){a.hide()}).render(h)});a.get("footer").append(h)})};o.NAME="dialog";c.extend(o,l);c.add({Module:m,Overlay:n,Panel:l,SimpleDialog:o})});
