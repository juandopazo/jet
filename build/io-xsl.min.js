/*
 Copyright (c) 2010, Juan Ignacio Dopazo. All rights reserved.
 Code licensed under the BSD License
 http://code.google.com/p/jet-js/wiki/Licence
*/
jet().add("io-xsl",function(g){var m=g.win,k=g.Lang,l=function(b,i,h){h=h||{};if(m.XSLTProcessor)l=function(j,a,c){var e=new window.XSLTProcessor,d;e.importStylesheet(a);for(d in c)c.hasOwnProperty(d)&&e.setParameter(null,d,c[d]);return g(e.transformToFragment(j,g.context))};else if(m.ActiveXObject)l=function(j,a,c){var e=new window.ActiveXObject("Msxml2.XSLTemplate.6.0"),d;e.stylesheet=a;a=e.createProcessor();a.input=j;for(d in c)c.hasOwnProperty(d)&&a.addParameter(d,c[d]);a.transform();return g(a.output)};
return l(b,i,h)};g.IO.xsl=function(b){var i=b.xml,h=b.xsl,j=b.params,a,c,e=function(f){b.error&&b.error(f);b.complete&&b.complete(f)},d=function(){if(a&&c){var f=l(a,c,j);b.success&&b.success(f);b.complete&&b.complete(f)}};if(k.isString(i)||k.isString(h)){if(k.isString(i))g.ajax({url:i,dataType:"xml",success:function(f){a=f;d()},error:e});else a=i;if(k.isString(h))g.ajax({url:h,dataType:"xsl",success:function(f){c=f;d()},error:e});else c=h}else{c=a=i;d()}}});
