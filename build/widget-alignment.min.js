/**
 * @module widget-alignment
 * @requires base
 * 
 * Copyright (c) 2011, Juan Ignacio Dopazo. All rights reserved.
 * Code licensed under the BSD License
 * https://github.com/juandopazo/jet/blob/master/LICENSE.md
*/
jet.add("widget-alignment",function(l){function a(){}function m(){this._repositionUI()}var n=l.UA.support.fixed,q=l.DOM;l.mix(a,{Top:"t",Middle:"m",Bottom:"b",Left:"l",Center:"c",Right:"r"});l.mix(a,{TopLeft:a.Top+a.Left,TopCenter:a.Top+a.Center,TopRight:a.Top+a.Right,MiddleLeft:a.Middle+a.Left,MiddleCenter:a.Middle+a.Center,MiddleRight:a.Middle+a.Right,BottomLeft:a.Bottom+a.Left,BottomCenter:a.Bottom+a.Center,BottomRight:a.Bottom+a.Right});a.prototype={_getPositionTop:function(e,f,d,h,b,c,i,j,k){var g=
0;switch(e){case a.Middle:g-=d/2;break;case a.Bottom:g-=d;break}switch(f){case a.Middle:b+=h/2;break;case a.Bottom:b+=h;break}if(j&&!n)b+=q.scrollTop();b+=g+c;if(k)if(b<0)b=0;else if(b>i-d)b=i-d;return b+"px"},_getPositionLeft:function(e,f,d,h,b,c,i,j,k){var g=0;switch(e){case a.Center:g-=d/2;break;case a.Right:g-=d;break}switch(f){case a.Center:b+=h/2;break;case a.Right:b+=h;break}if(j&&!n)b+=q.scrollLeft();b+=g+c;if(k)if(b<0)b=0;else if(b>i-d)b=i-d;return b+"px"},_getPositionBottom:function(e,f,
d,h,b){var c=0;switch(e){case a.Top:c-=f;break;case a.Middle:c-=f/2;break}c-=d;if(h&&!n)c-=q.scrollTop();if(b)c=Math.max(c,0);return c+"px"},_getPositionRight:function(e,f,d,h,b){var c=0;switch(e){case a.Left:c-=f;break;case a.Center:c-=f/2;break}c-=d;if(h&&!n)c-=q.scrollTop();if(b)c=Math.max(c,0);return c+"px"},_repositionUI:function(){var e=this.get("align"),f=e.points||[a.TopLeft,a.TopLeft],d=e.offset||[0,0];e=e.node?l(e.node):null;var h=this.get(this.get("alignedBox")),b=e?e.offset():null,c=h.offset(),
i=this.get("fixed"),j=this.get("constrain"),k=q.screenSize(),g=f[0],o=f[1];f=g.substr(0,1);g=g.substr(1);var r=o.substr(0,1);o=o.substr(1);var s=this._getPositionLeft,t=this._getPositionTop,p={};if(e)p={left:s(g,o,c.width,b.width,b.left,d[0]||0,k.width,i,j),top:t(f,r,c.height,b.height,b.top,d[1]||0,k.height,i,j)};else{if(r==a.Bottom)p.bottom=this._getPositionBottom(f,c.height,d[1],i,j);else p.top=t(f,r,c.height,k.height,0,d[1]||0,k.height,i,j);if(o==a.Right)p.right=this._getPositionRight(g,c.width,
d[0],i,j);else p.left=s(g,o,c.width,k.width,0,d[0]||0,k.width,i,j)}h.css(p)}};l.mix(a,{ATTRS:{fixed:{value:false},constrain:{value:false},align:{value:{points:[a.TopLeft,a.TopLeft],offset:[0,0]}},alignedBox:{value:"boundingBox",writeOnce:true}},EVENTS:{render:function(){var e=this.get("fixed"),f=l(this.get("win"));this.get("boundingBox").css("position",e&&n?"fixed":"absolute");this._handlers.push(f.on("resize",this._repositionUI,this));e&&!n&&this._handlers.push(f.on("scroll",this._repositionUI,this));
this._repositionUI()},afterRender:m,afterFixedChange:m,afterConstrainChange:m,afterAlignChange:m,afterWidthChange:m,afterHeightChange:m}});l.WidgetAlignment=a});
