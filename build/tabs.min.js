/*
 Copyright (c) 2010, Juan Ignacio Dopazo. All rights reserved.
 Code licensed under the BSD License
 http://code.google.com/p/jet-js/wiki/Licence
*/
jet().add("tabs",function(h){var j=h.Lang,n=h.Array,i=function(){i.superclass.constructor.apply(this);var c=this.addAttrs({label:{required:true,setter:function(b){return j.isString(b)?h.create("li").append(h.create("a").html(b)):h(b)}},panel:{required:true,setter:function(b){return j.isString(b)?h.create("div").html(b):h(b)}},selected:{value:false}}).addAttrs({labelContent:{setter:function(b){var f=c.get("label");f.children().remove();f.append(b);return b}},triggerEvent:{value:"click"},panelContent:{setter:function(b){var f=
c.get("panel");f.children().remove();f.append(b);return b}}}),d=function(b){b.preventDefault();b.stopPropagation();c.select()};this.get("label").first().on(c.get("triggerEvent"),d);this.on("triggerEventChange",function(b,f,g){this.get("label").first().unbind(f,d).on(g,d)})};h.extend(i,h.Base,{select:function(c){c=c||false;var d=this.set("selected",true);d.get("label").addClass("selected");d.get("panel").show();c||d.fire("selected");return d},unselect:function(c){c=c||false;var d=this.set("selected",
false);d.get("label").removeClass("selected");d.get("panel").hide();c||d.fire("unselected");return d},remove:function(){if(this.fire("remove")){this.get("label").remove();this.get("panel").remove()}}});var l=function(){l.superclass.constructor.apply(this,arguments);var c=this,d=c.get("srcNode");c.set("boundingBox",d);var b,f,g=[],o=function(){var a=this;n.each(g,function(e){e!=a&&e.unselect()});c.fire("tabSelect",a)},p=function(){g.splice(this.index,1);this.selected&&c.select(0);for(var a=this.index;a<
g.length;a++)g[a].index=a};c.on("render",function(a,e){e&&c.set("boundingBox",h(e));b=d.children("ul").eq(0);f=d.children("div");f.getNodes().length>0&&f.notEq(0).hide();b.getNodes().length>0&&b.children().each(function(q,m){var k=new i({label:q,panel:f.eq(m).getNode()?f.eq(m):""});k.index=m;k.on("selected",o);k.on("remove",p);g[g.length]=k});return c});this.add=function(a,e){a instanceof i||(a=new i(a));if(j.isNumber(e)&&e<g.length-1){a.get("label").insertBefore(b.children(e));a.get("panel").insertBefore(f.eq(e))}else{a.get("label").appendTo(b);
a.get("panel").appendTo(d)}g.splice(e,0,a);return c};this.remove=function(a){if(j.isNumber(a))g[a].remove();else a.nodeType?n.each(g,function(e){if(e.label==a||e.panel==a)e.remove()}):a.remove();return c};this.select=function(a){j.isNumber(a)?g[a].select():a.select();return c};this.getTab=function(a){return g[a]}};h.extend(l,h.Widget);h.add({Tab:i,TabView:l})});
