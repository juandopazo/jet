/*
 Copyright (c) 2010, Juan Ignacio Dopazo. All rights reserved.
 Code licensed under the BSD License
 http://code.google.com/p/jet-js/wiki/Licence
*/
jet().add("tabs",function(f){var j=f.Lang,n=f.Array,i=function(){i.superclass.constructor.apply(this,arguments);var c=this.addAttrs({label:{required:true,setter:function(b){return j.isString(b)?f("<li/>").append(f("<a/>").html(b)):f(b)}},panel:{required:true,setter:function(b){return j.isString(b)?f("<div/>").html(b):f(b)}},selected:{value:false}}).addAttrs({labelContent:{setter:function(b){var g=c.get("label");g.children().remove();g.append(b);return b}},triggerEvent:{value:"click"},panelContent:{setter:function(b){var g=
c.get("panel");g.children().remove();g.append(b);return b}}}),d=function(b){b.preventDefault();b.stopPropagation();c.select()};this.get("label").first().on(c.get("triggerEvent"),d);this.on("triggerEventChange",function(b,g,h){this.get("label").first().unbind(g,d).on(h,d)})};f.extend(i,f.Base,{select:function(c){c=c||false;var d=this.set("selected",true);d.get("label").addClass("selected");d.get("panel").show();c||d.fire("selected");return d},unselect:function(c){c=c||false;var d=this.set("selected",
false);d.get("label").removeClass("selected");d.get("panel").hide();c||d.fire("unselected");return d},remove:function(){if(this.fire("remove")){this.get("label").remove();this.get("panel").remove()}}});var l=function(){l.superclass.constructor.apply(this,arguments);var c=this,d=c.get("srcNode");c.set("boundingBox",d);var b=d.children("ul").eq(0),g,h=[],o=function(){var a=this;n.each(h,function(e){e!=a&&e.unselect()});c.fire("tabSelect",a)},p=function(){h.splice(this.index,1);this.selected&&c.select(0);
for(var a=this.index;a<h.length;a++)h[a].index=a};if(b.length==0)b=f("<ul/>").prependTo(d);c.on("render",function(a,e){e&&c.set("boundingBox",f(e));g=d.children("div");g.length>0&&g.notEq(0).hide();b.length>0&&b.children().each(function(q,m){var k=new i({label:q,panel:g.eq(m).getNode()?g.eq(m):""});k.index=m;k.on("selected",o);k.on("remove",p);h[h.length]=k});return c});this.add=function(a,e){a instanceof i||(a=new i(a));if(j.isNumber(e)&&e<h.length-1){a.get("label").insertBefore(b.children(e));a.get("panel").insertBefore(g.eq(e))}else{a.get("label").appendTo(b);
a.get("panel").appendTo(d)}h.splice(e,0,a);return c};this.remove=function(a){if(j.isNumber(a))h[a].remove();else a.nodeType?n.each(h,function(e){if(e.label==a||e.panel==a)e.remove()}):a.remove();return c};this.select=function(a){j.isNumber(a)?h[a].select():a.select();return c};this.getTab=function(a){return h[a]}};f.extend(l,f.Widget);f.add({Tab:i,TabView:l})});
