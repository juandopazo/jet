/*
 Copyright (c) 2010, Juan Ignacio Dopazo. All rights reserved.
 Code licensed under the BSD License
 http://code.google.com/p/jet-js/wiki/Licence
*/
jet().add("tabs",function(e){var j=e.Lang,n=e.Array,h=function(){h.superclass.constructor.apply(this);var c=this;c.addAttrs({label:{required:true,setter:function(a){return j.isString(a)?e.create("li").append(e.create("a").html(a)):e(a)}},panel:{required:true,setter:function(a){return j.isString(a)?e.create("div").html(a):e(a)}},selected:{value:false}}).addAttrs({labelContent:{setter:function(a){var g=c.get("label");g.children().remove();g.append(a);return a}},panelContent:{setter:function(a){var g=
c.get("panel");g.children().remove();g.append(a);return a}}}).get("label").first().on("click",function(a){a.preventDefault();a.stopPropagation();c.select()})};e.extend(h,e.Attribute,{select:function(c){c=c||false;var a=this.set("selected",true);a.get("label").addClass("selected");a.get("panel").show();c||a.fire("selected");return a},unselect:function(c){c=c||false;var a=this.set("selected",false);a.get("label").removeClass("selected");a.get("panel").hide();c||a.fire("unselected");return a},remove:function(){if(this.fire("remove")){this.get("label").remove();
this.get("panel").remove()}}});var l=function(){l.superclass.constructor.apply(this,arguments);var c=this,a=c.get("srcNode");c.set("boundingBox",a);var g,i,f=[],o=function(){var b=this;n.each(f,function(d){d!=b&&d.unselect()});c.fire("tabSelect",b)},p=function(){f.splice(this.index,1);this.selected&&c.select(0);for(var b=this.index;b<f.length;b++)f[b].index=b};c.on("render",function(b,d){d&&c.set("boundingBox",e(d));g=a.children("ul").eq(0);i=a.children("div");i.getNodes().length>0&&i.notEq(0).hide();
g.getNodes().length>0&&g.children().each(function(q,m){var k=new h({label:q,panel:i.eq(m).getNode()?i.eq(m):""});k.index=m;k.on("selected",o);k.on("remove",p);f[f.length]=k});return c});this.add=function(b,d){b instanceof h||(b=new h(b));if(j.isNumber(d)&&d<f.length-1){b.get("label").insertBefore(g.children(d));b.get("panel").insertBefore(i.eq(d))}else{b.get("label").appendTo(g);b.get("panel").appendTo(a)}f.splice(d,0,b);return c};this.remove=function(b){if(j.isNumber(b))f[b].remove();else b.nodeType?
n.each(f,function(d){if(d.label==b||d.panel==b)d.remove()}):b.remove();return c};this.select=function(b){j.isNumber(b)?f[b].select():b.select();return c};this.getTab=function(b){return f[b]}};e.extend(l,e.Widget);e.add({Tab:h,TabView:l})});
