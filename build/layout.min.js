/**
 * @module layout
 * @requires base,resize,widget-parentchild
 * 
 * Copyright (c) 2011, Juan Ignacio Dopazo. All rights reserved.
 * Code licensed under the BSD License
 * https://github.com/juandopazo/jet/blob/master/LICENSE.md
*/
jet.add("layout",function(d){function b(){}b.Vertical="v";b.Horizontal="h";d.mix(b,{ATTRS:{direction:{value:b.Vertical,writeOnce:true},minSize:{value:0,wriceOnce:true},shim:{value:false,writeOnce:true},defaultChildType:{value:"LayoutPanel"}},EVENTS:{afterRender:"_uiLayoutRender",afterAddChild:"_setupChildResize",removeChild:"_destroyChildResize"},HTML_PARSER:{direction:function(a){return a.hasClass(this.getClassName(b.Horizontal))?b.Horizontal:b.Vertical}}});b.prototype={_uiLayoutRender:function(){var a=
this.get("direction"),c=this.get("boundingBox"),e=a==b.Horizontal?"width":"height",g=0,f=0,i=this.get("children").length;i>0&&c.addClass(this.getClassName(a));this.each(function(h){g+=h.get(e)||0});f=(c[e]()-g)/i;this.each(function(h){h.get(e)||h.set(e,f)})},_setupChildResize:function(a){var c=d.Resize,e=this.get("minSize"),g=this.get("direction"),f=a.child;if(a.index>0){f.resize=new c({node:f.get("boundingBox"),handles:[g==b.Horizontal?c.Left:c.Top],minWidth:e,minHeight:e,shim:this.get("shim")});
f.resize.on("resize:start",this._onChildResizeStart,f);f.resize.on("resize",this._onChildResize,f)}f.get("boundingBox").addClass(f.getClassName("child",g))},_destroyChildResize:function(a){a.child.resize.destroy();a.child.resize=null},_onChildResizeStart:function(){var a=this.previous(),c=a.get("boundingBox");a._originalWidth=c.width();a._originalHeight=c.height()},_onChildResize:function(a){var c=a.target,e=this.previous(),g=e.get("boundingBox");this.get("parent").get("direction")==b.Horizontal?
g.width(c.get("originalWidth")-a.width+e._originalWidth):g.height(c.get("originalHeight")-a.height+e._originalHeight)}};d.LayoutPanel=d.Base.create("layout-panel",d.Widget,[b,d.WidgetParent,d.WidgetChild],{},{CONTENT_TEMPLATE:null});d.Layout=d.Base.create("layout",d.Widget,[b,d.WidgetParent],{},{CONTENT_TEMPLATE:null})});
