/*
 Copyright (c) 2010, Juan Ignacio Dopazo. All rights reserved.
 Code licensed under the BSD License
 http://code.google.com/p/jet-js/wiki/Licence
*/
jet().add("anim",function(g){var o=g.Lang,r=g.Hash,y=g.Array,s=function(b){return!o.isString(b)?b:b.substr(-2,b.length)=="px"?parseFloat(b.substr(0,b.length-2)):parseFloat(b)},t={linear:function(b,c,a,d){return(a-c)*b/d+c},easein:function(b,c,a,d,e){return a-(a-c)*Math.pow((a>=c?-1:1)*(b/d-1),e)},easeout:function(b,c,a,d,e){return c+(a-c)*Math.pow(b/d,e)},sling:function(b,c,a,d,e){c=[c,c+(a<c?1:-1)*e,a];b=b/d;d=c.length;a=[];for(e=0;e<d;++e)a[e]=c[e];for(c=1;c<d;++c)for(e=0;e<d-c;++e)a[e]=(1-b)*a[e]+
b*a[parseInt(e+1,10)];return a[0]}};if(!jet.TimeFrame){jet.TimeFrame=function(){var b=[],c,a=false;return{fps:50,play:function(){var d=this;if(!a){c&&clearInterval(c);c=setInterval(function(){d.fire("enterFrame",(new Date).getTime())},Math.round(1E3/d.fps));a=true}return d},stop:function(){c&&clearInterval(c);a=false;return this},addTween:function(d){b[b.length]=d;return this},removeTween:function(d){y.remove(d,b);return b.length===0?this.stop():this}}}();g.mix(jet.TimeFrame,new g.EventTarget)}var p=
function(){p.superclass.constructor.apply(this,arguments);var b=jet.TimeFrame,c=false,a=this.addAttrs({node:{writeOnce:true,required:true,setter:function(h){return g(h)}},from:{value:false},to:{required:true},easing:{value:t.linear},easingStrength:{value:2,validator:function(h){return h>=0}},duration:{value:1E3,setter:function(h){return h=="fast"?500:h=="slow"?4E3:o.isNumber(h)?h:1E3}}}),d=a.get("node"),e,j,n,u=0,k,v,x,w=function(h,i){if(c){n||(n=i);var f=i-n+u;r.keys(j);r.each(j,function(l,m){var q=
k(f,e[l],m,v,x);if(m>e[l]&&q>m||m<e[l]&&q<m)q=m;d.css(l,q)});if(f>=v){a.stop();a.fire("complete")}}};a.play=function(){var h=d.currentStyle();c=true;e=a.get("from")||{};j=a.get("to");var i=d.offset();r.each(j,function(f,l){j[f]=s(l);if(!e[f])switch(f){case "left":e[f]=i.left;break;case "top":e[f]=i.top;break;case "width":e[f]=i.width;break;case "height":e[f]=i.height;break;default:e[f]=o.isNumber(s(h[f]))?s(h[f]):0}});k=a.get("easing");k=o.isFunction(k)?k:t[k];v=a.get("duration");x=a.get("easingStrength");
b.on("enterFrame",w);b.addTween(a).play();return a};a.stop=function(){c=false;b.removeTween(a);b.unbind("enterFrame",w);u=n=0;return a};a.pause=function(){c=false;b.removeTween(a);b.unbind("enterFrame",w);u=(new Date).getTime()-n;return a};a.reverse=function(){return a.set("from",j).set("to",e)}};g.extend(p,g.Base);g.augment(g.NodeList,{animate:function(b,c,a,d){this.tw=(new p({node:this,to:b,duration:c,easing:a})).on("complete",d).play();return this},fadeIn:function(b,c,a){return this.animate({opacity:1},
b,c,a)},fadeOut:function(b,c,a){return this.animate({opacity:0},b,c,a)},fadeToggle:function(b,c,a){return this.each(function(d){d=g(d);d.css("opacity")==1?d.fadeOut(b,c,a):d.fadeIn(b,c,a)})},slideDown:function(b,c,a){var d=this,e=d.css("overflow");return d.css("overflow","hidden").animate({height:d.oHeight},b,c,function(){d.css("overflow",e);a.call(d)})},slideUp:function(b,c,a){var d=this,e=d.css("overflow");return d.css("overflow","hidden").animate({height:0},b,c,function(){d.css("overflow",e);a.call(d)})},
stop:function(){this.tw&&this.tw.stop();return this}});g.add({Tween:p,Easing:t})});
