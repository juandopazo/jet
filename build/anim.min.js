/*
 Copyright (c) 2010, Juan Ignacio Dopazo. All rights reserved.
 Code licensed under the BSD License
 http://code.google.com/p/jet-js/wiki/Licence
*/
jet().add("anim",function(f){var q=f.Lang,r=f.Hash,y=f.Array,w=function(b){return!q.isString(b)?b:b.substr(-2,b.length)=="px"?parseFloat(b.substr(0,b.length-2)):parseFloat(b)},s={linear:function(b,c,a,d){return(a-c)*b/d+c},easein:function(b,c,a,d,e){return a-(a-c)*Math.pow((a>=c?-1:1)*(b/d-1),e)},easeout:function(b,c,a,d,e){return c+(a-c)*Math.pow(b/d,e)},sling:function(b,c,a,d,e){c=[c,c+(a<c?1:-1)*e,a];b=b/d;d=c.length;a=[];for(e=0;e<d;++e)a[e]=c[e];for(c=1;c<d;++c)for(e=0;e<d-c;++e)a[e]=(1-b)*a[e]+
b*a[parseInt(e+1,10)];return a[0]}};if(!jet.TimeFrame){jet.TimeFrame=function(){var b=[],c,a=false;return{fps:50,play:function(){var d=this;if(!a){c&&clearInterval(c);c=setInterval(function(){d.fire("enterFrame",(new Date).getTime())},Math.round(1E3/d.fps));a=true}return d},stop:function(){c&&clearInterval(c);a=false;return this},addTween:function(d){b[b.length]=d;return this},removeTween:function(d){y.remove(d,b);return b.length===0?this.stop():this}}}();f.mix(jet.TimeFrame,new f.EventTarget)}var o=
function(){o.superclass.constructor.apply(this,arguments);var b=jet.TimeFrame,c=false,a=this.addAttrs({node:{writeOnce:true,required:true,setter:function(h){return f(h)}},from:{value:false},to:{required:true},easing:{value:s.linear},easingStrength:{value:2,setter:function(h){return Math.abs(h)}},duration:{value:1E3,setter:function(h){return h=="fast"?500:h=="slow"?4E3:q.isNumber(h)?h:1E3}}}),d=a.get("node"),e,j,n,t=0,k,u,x,v=function(h,i){if(c){n||(n=i);var g=i-n+t;r.keys(j);r.each(j,function(l,m){var p=
k(g,e[l],m,u,x);if(m>e[l]&&p>m||m<e[l]&&p<m)p=m;d.css(l,p)});if(g>=u){a.stop();a.fire("complete")}}};a.play=function(){var h=d.currentStyle();c=true;e=a.get("from")||{};j=a.get("to");var i=d.offset();r.each(j,function(g,l){j[g]=w(l);if(!e[g])switch(g){case "left":e[g]=i.left;break;case "top":e[g]=i.top;break;case "width":e[g]=i.width;break;case "height":e[g]=i.height;break;default:e[g]=w(h[g])}});k=a.get("easing");k=q.isFunction(k)?k:s[k];u=a.get("duration");x=a.get("easingStrength");b.on("enterFrame",
v);b.addTween(a).play();return a};a.stop=function(){c=false;b.removeTween(a);b.unbind("enterFrame",v);t=n=0;return a};a.pause=function(){c=false;b.removeTween(a);b.unbind("enterFrame",v);t=(new Date).getTime()-n;return a};a.reverse=function(){return a.set("from",j).set("to",e)}};f.extend(o,f.Base);f.augment(f.NodeList,{animate:function(b,c,a,d){this.tw=(new o({node:this,to:b,duration:c,easing:a})).on("complete",d).play();return this},fadeIn:function(b,c){return this.animate({opacity:1},b,null,c)},
fadeOut:function(b,c){return this.animate({opacity:0},b,null,c)},fadeToggle:function(b,c){return this.each(function(a){a=f(a);a.css("opacity")==1?a.fadeOut(b,c):a.fadeIn(b,c)})},slideDown:function(b,c){var a=this,d=a.css("overflow");return a.css("overflow","hidden").animate({height:a.oHeight},b,null,function(){a.css("overflow",d);c.call(a)})},slideUp:function(b,c){var a=this,d=a.css("overflow");return a.css("overflow","hidden").animate({height:0},b,null,function(){a.css("overflow",d);c.call(a)})},
stop:function(){this.tw&&this.tw.stop();return this}});f.add({Tween:o,Easing:s})});
