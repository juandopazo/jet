/**
 * @module selector
 * @requires 
 * 
 * Copyright (c) 2011, Juan Ignacio Dopazo. All rights reserved.
 * Code licensed under the BSD License
 * https://github.com/juandopazo/jet/blob/master/LICENSE.md
*/
jet.add("selector",function(K){(function(g,d){function j(a){v=[];n=0;for(L=a.length;n<L;n++)v[n]=a[n];return v}function r(a,b,c,h,s,f,o){var B,i;if(b&&this.tagName.toLowerCase()!==b)return false;if(c&&(B=c.match(X))&&B[1]!==this.id)return false;if(c&&(I=c.match(Y)))for(n=I.length;n--;){a=I[n].slice(1);if(!(C.g(a)||C.s(a,RegExp("(^|\\s+)"+a+"(\\s+|$)"))).test(this.className))return false}if(h&&!o){D=this.attributes;for(i in D)if(Object.prototype.hasOwnProperty.call(D,i)&&(D[i].name||i)==s)return this}if(h&&
!Z(f,this.getAttribute(s)||"",o))return false;return this}function w(a){return M.g(a)||M.s(a,a.replace($,"\\$1"))}function Z(a,b,c){switch(a){case "=":return b==c;case "^=":return b.match(l.g("^="+c)||l.s("^="+c,RegExp("^"+w(c))));case "$=":return b.match(l.g("$="+c)||l.s("$="+c,RegExp(w(c)+"$")));case "*=":return b.match(l.g(c)||l.s(c,RegExp(w(c))));case "~=":return b.match(l.g("~="+c)||l.s("~="+c,RegExp("(?:^|\\s+)"+w(c)+"(?:\\s+|$)")));case "|=":return b.match(l.g("|="+c)||l.s("|="+c,RegExp("^"+
w(c)+"(-|$)")))}return false}function aa(a,b,c){c=typeof b=="string"?c(b)[0]:b||d;if(a===window||a&&a.nodeType&&(a.nodeType==1||a.nodeType==9))return!b||a!==window&&c&&c.nodeType&&(c.nodeType==1||c.nodeType==9)&&N(a,c)?[a]:[];if(a&&typeof a==="object"&&isFinite(a.length))return j(a);if(e=a.match(O))return(E=d.getElementById(e[1]))?[E]:[];if(e=a.match(ba))return j(c.getElementsByTagName(e[1]));return false}function P(a){var b=[],c,h;c=0;a:for(;c<a.length;c++){for(h=0;h<b.length;h++)if(b[h]==a[c])continue a;
b[b.length]=a[c]}return b}function x(a,b){var c=typeof b=="string"?x(b)[0]:b||d;if(!c||!a)return[];if(e=aa(a,b,x))return e;return ca(a,c)}var n,m,Q,t,e,D,y,v,E,R,L,S,I,T,q,X=/#([\w\-]+)/,Y=/\.[\w\-]+/g,O=/^#([\w\-]+$)/,da=/^\.([\w\-]+)$/,ba=/^([\w\-]+)$/,ea=/^([\w]+)?\.([\w\-]+)$/,F=d.documentElement,fa=/\s(?![\s\w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^'"]*\])/,$=/([.*+?\^=!:${}()|\[\]\/\\])/g,U=RegExp(/^([a-z0-9]+)?(?:([\.\#]+[\w\-\.#]+)?)/.source+"("+/\[([\w\-]+)(?:([\|\^\$\*\~]?\=)['"]?([ \w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^]+)["']?)?\]/.source+
")?"),z=function(){this.c={}};z.prototype={g:function(a){return this.c[a]||undefined},s:function(a,b){return this.c[a]=b}};var C=new z,M=new z,l=new z,V=new z,N="compareDocumentPosition"in F?function(a,b){return(b.compareDocumentPosition(a)&16)==16}:"contains"in F?function(a,b){b=b==d||b==window?F:b;return b!==a&&b.contains(a)}:function(a,b){for(;a=a.parentNode;)if(a===b)return 1;return 0},ca=d.querySelector&&d.querySelectorAll?function(a,b){if(d.getElementsByClassName&&(e=a.match(da)))return j(b.getElementsByClassName(e[1]));
return j(b.querySelectorAll(a))}:function(a,b){var c=[],h,s=[],f;if(e=a.match(ea)){q=b.getElementsByTagName(e[1]||"*");v=C.g(e[2])||C.s(e[2],RegExp("(^|\\s+)"+e[2]+"(\\s+|$)"));f=0;t=q.length;for(m=0;f<t;f++)v.test(q[f].className)&&(c[m++]=q[f]);return c}f=0;q=a.split(",");for(t=q.length;f<t;f++){var o=s,B=f,i;var k=q[f],p=[];i=[];var u=void 0,G=void 0;k=V.g(k)||V.s(k,k.split(fa));k=k.slice(0);if(k.length){var A=k;p=[];u=A.pop().match(U);G=u[1]||"*";var H=void 0,W=void 0,J=void 0;if(A=A.length&&(e=
A[0].match(O))?d.getElementById(e[1]):d){J=A.getElementsByTagName(G);H=0;for(W=J.length;H<W;H++){E=J[H];if(T=r.apply(E,u))p.push(T)}}p=p;if(k.length){m=0;G=p.length;for(Q=0;m<G;m++){y=R=p[m];for(u=k.length;u--;)b:for(;y!==F&&(y=y.parentNode);)if(S=r.apply(y,k[u].match(U)))break b;S&&(i[Q++]=R)}i=i}else i=p}else i=p;o[B]=i}f=0;for(t=s.length;f<t&&(h=s[f]);f++){o=h;if(b!==d){o=[];m=0;for(e=h.length;m<e&&(element=h[m]);m++)N(element,b)&&o.push(element)}c=c.concat(o)}return P(c)};x.uniq=P;var ga=g.qwery;
x.noConflict=function(){g.qwery=ga;return this};g.qwery=x})(this,document);K.find=function(g,d){d=d||K.context;var j,r=null;if(g.charAt(0)==="<"&&g.charAt(g.length-1)===">")if(g.match(/</g).length===1)return d.createElement(g.substr(1,g.length-(g.charAt(g.length-2)==="/"?3:2)));else{j=g.match(/<([a-z]+)>(.+)<\/([a-z]+)>/i);if(j.length==4&&j[1]==j[3]){r=d.createElement(j[1]);r.innerHTML=j[2]}return r}else return g(g,d)}});
