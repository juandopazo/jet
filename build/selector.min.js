/**
 * @module selector
 * @requires 
 * 
 * Copyright (c) 2011, Juan Ignacio Dopazo. All rights reserved.
 * Code licensed under the BSD License
 * https://github.com/juandopazo/jet/blob/master/LICENSE.md
*/
jet.add("selector",function(w){(function(g,e){function h(){this.c={}}function o(a){x=[];p=0;for(F=a.length;p<F;p++)x[p]=a[p];return x}function G(a){for(;a=a.previousSibling;)if(a.nodeType==1)break;return a}function H(a,b,c,d,j,f,k,r,l,t,m){var y,A;if(b&&this.tagName.toLowerCase()!==b)return false;if(c&&(y=c.match(S))&&y[1]!==this.id)return false;if(c&&(E=c.match(T)))for(p=E.length;p--;){a=E[p].slice(1);if(!(B.g(a)||B.s(a,new RegExp("(^|\\s+)"+a+"(\\s+|$)"))).test(this.className))return false}if(l&&
q.pseudos[l]&&!q.pseudos[l](this,m))return false;if(d&&!k){C=this.attributes;for(A in C)if(Object.prototype.hasOwnProperty.call(C,A)&&(C[A].name||A)==j)return this}if(d&&!U(f,this.getAttribute(j)||"",k))return false;return this}function z(a){return I.g(a)||I.s(a,a.replace(V,"\\$1"))}function U(a,b,c){switch(a){case "=":return b==c;case "^=":return b.match(n.g("^="+c)||n.s("^="+c,new RegExp("^"+z(c))));case "$=":return b.match(n.g("$="+c)||n.s("$="+c,new RegExp(z(c)+"$")));case "*=":return b.match(n.g(c)||
n.s(c,new RegExp(z(c))));case "~=":return b.match(n.g("~="+c)||n.s("~="+c,new RegExp("(?:^|\\s+)"+z(c)+"(?:\\s+|$)")));case "|=":return b.match(n.g("|="+c)||n.s("|="+c,new RegExp("^"+z(c)+"(-|$)")))}return 0}function W(a){var b=[],c=[],d,j=0,f,k,r,l,t,m=J.g(a)||J.s(a,a.split(X));a=a.match(Y);m=m.slice(0);if(!m.length)return b;k=m.pop();l=m.length&&(d=m[m.length-1].match(K))?e.getElementById(d[1]):e;if(!l)return b;t=k.match(L);f=a&&/^[+~]$/.test(a[a.length-1])?function(y){for(;l=l.nextSibling;)l.nodeType==
1&&(t[1]?t[1]==l.tagName.toLowerCase():1)&&y.push(l);return y}([]):l.getElementsByTagName(t[1]||"*");d=0;for(k=f.length;d<k;d++)if(r=H.apply(f[d],t))b[j++]=r;if(!m.length)return b;j=0;k=b.length;for(f=0;j<k;j++){r=b[j];for(d=m.length;d--;)for(;r=Z[a[d]](r,b[j]);)if(M=H.apply(r,m[d].match(L)))break;M&&(c[f++]=b[j])}return c}function $(a,b,c){c=typeof b=="string"?c(b)[0]:b||e;if(a===window||a&&a.nodeType&&(a.nodeType==1||a.nodeType==9))return!b||a!==window&&c&&c.nodeType&&(c.nodeType==1||c.nodeType==
9)&&N(a,c)?[a]:[];if(a&&typeof a==="object"&&isFinite(a.length))return o(a);if(i=a.match(K))return(O=e.getElementById(i[1]))?[O]:[];if(i=a.match(aa))return o(c.getElementsByTagName(i[1]));return false}function P(a){var b=[],c,d;c=0;a:for(;c<a.length;c++){for(d=0;d<b.length;d++)if(b[d]==a[c])continue a;b[b.length]=a[c]}return b}function q(a,b){var c=typeof b=="string"?q(b)[0]:b||e;if(!c||!a)return[];if(i=$(a,b,q))return i;return ba(a,c)}var p,u,v,i,C,x,O,F,M,E,s,D=e.documentElement,S=/#([\w\-]+)/,
T=/\.[\w\-]+/g,K=/^#([\w\-]+$)/,ca=/^\.([\w\-]+)$/,aa=/^([\w\-]+)$/,da=/^([\w]+)?\.([\w\-]+)$/,ea=/\s*([\s\+\~>])\s*/g,Q=/[\s\>\+\~]/,R=/(?![\s\w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^'"]*\])/,Y=new RegExp("("+Q.source+")"+R.source,"g"),X=new RegExp(Q.source+R.source),V=/([.*+?\^=!:${}()|\[\]\/\\])/g,L=new RegExp(/^([a-z0-9]+)?(?:([\.\#]+[\w\-\.#]+)?)/.source+"("+/\[([\w\-]+)(?:([\|\^\$\*\~]?\=)['"]?([ \w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^]+)["']?)?\]/.source+")?("+/:([\w\-]+)(\(['"]?(\w+)['"]?\))?/.source+
")?"),Z={" ":function(a){return a&&a!==D&&a.parentNode},">":function(a,b){return a&&a.parentNode==b.parentNode&&a.parentNode},"~":function(a){return a&&a.previousSibling},"+":function(a,b,c,d){if(!a)return false;c=G(a);d=G(b);return c&&d&&c==d&&c}};h.prototype={g:function(a){return this.c[a]||undefined},s:function(a,b){return this.c[a]=b}};var B=new h,I=new h,n=new h,J=new h,N="compareDocumentPosition"in D?function(a,b){return(b.compareDocumentPosition(a)&16)==16}:"contains"in D?function(a,b){b=b==
e||b==window?D:b;return b!==a&&b.contains(a)}:function(a,b){for(;a=a.parentNode;)if(a===b)return 1;return 0},ba=e.querySelector&&e.querySelectorAll?function(a,b){if(e.getElementsByClassName&&(i=a.match(ca)))return o(b.getElementsByClassName(i[1]));return o(b.querySelectorAll(a))}:function(a,b){a=a.replace(ea,"$1");var c=[],d,j=[],f;if(i=a.match(da)){s=b.getElementsByTagName(i[1]||"*");x=B.g(i[2])||B.s(i[2],new RegExp("(^|\\s+)"+i[2]+"(\\s+|$)"));f=0;v=s.length;for(u=0;f<v;f++)x.test(s[f].className)&&
(c[u++]=s[f]);return c}f=0;s=a.split(",");for(v=s.length;f<v;f++)j[f]=W(s[f]);f=0;for(v=j.length;f<v&&(d=j[f]);f++){var k=d;if(b!==e){k=[];u=0;for(i=d.length;u<i&&(element=d[u]);u++)N(element,b)&&k.push(element)}c=c.concat(k)}return P(c)};q.uniq=P;q.pseudos={};var fa=g.qwery;q.noConflict=function(){g.qwery=fa;return this};g.qwery=q})(this,document);var ga=w.qwery;delete w.qwery;w.find=function(g,e){e=e||w.config.doc;if(e.getDOMNode)e=e.getDOMNode();var h,o=null;if(g.charAt(0)==="<"&&g.charAt(g.length-
1)===">")if(g.match(/</g).length===1)return e.createElement(g.substr(1,g.length-(g.charAt(g.length-2)==="/"?3:2)));else{h=g.match(/<([a-z]+)>(.+)<\/([a-z]+)>/i);if(h.length==4&&h[1]==h[3]){o=e.createElement(h[1]);o.innerHTML=h[2]}return o}else{if(g.charAt(0)===">"){h=e.id;if(!h)e.id=h=w.guid();g="#"+h+" "+g}return ga(g,e)}}});
