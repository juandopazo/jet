/**
 * @module selector
 * @requires 
 * 
 * Copyright (c) 2011, Juan Ignacio Dopazo. All rights reserved.
 * Code licensed under the BSD License
 * https://github.com/juandopazo/jet/blob/master/LICENSE.md
*/
jet.add("selector",function(z){(function(h,f){function k(){this.c={}}function o(a){w=[];p=0;for(F=a.length;p<F;p++)w[p]=a[p];return w}function G(a){for(;a=a.previousSibling;)if(a.nodeType==1)break;return a}function H(a,b,c,d,i,e,j,r,l,t,m){var x,A;if(b&&this.tagName.toLowerCase()!==b)return false;if(c&&(x=c.match(S))&&x[1]!==this.id)return false;if(c&&(E=c.match(T)))for(p=E.length;p--;){a=E[p].slice(1);if(!(B.g(a)||B.s(a,new RegExp("(^|\\s+)"+a+"(\\s+|$)"))).test(this.className))return false}if(l&&
q.pseudos[l]&&!q.pseudos[l](this,m))return false;if(d&&!j){C=this.attributes;for(A in C)if(Object.prototype.hasOwnProperty.call(C,A)&&(C[A].name||A)==i)return this}if(d&&!U(e,this.getAttribute(i)||"",j))return false;return this}function y(a){return I.g(a)||I.s(a,a.replace(V,"\\$1"))}function U(a,b,c){switch(a){case "=":return b==c;case "^=":return b.match(n.g("^="+c)||n.s("^="+c,new RegExp("^"+y(c))));case "$=":return b.match(n.g("$="+c)||n.s("$="+c,new RegExp(y(c)+"$")));case "*=":return b.match(n.g(c)||
n.s(c,new RegExp(y(c))));case "~=":return b.match(n.g("~="+c)||n.s("~="+c,new RegExp("(?:^|\\s+)"+y(c)+"(?:\\s+|$)")));case "|=":return b.match(n.g("|="+c)||n.s("|="+c,new RegExp("^"+y(c)+"(-|$)")))}return 0}function W(a){var b=[],c=[],d,i=0,e,j,r,l,t,m=J.g(a)||J.s(a,a.split(X));a=a.match(Y);m=m.slice(0);if(!m.length)return b;j=m.pop();l=m.length&&(d=m[m.length-1].match(K))?f.getElementById(d[1]):f;if(!l)return b;t=j.match(L);e=a&&/^[+~]$/.test(a[a.length-1])?function(x){for(;l=l.nextSibling;)l.nodeType==
1&&(t[1]?t[1]==l.tagName.toLowerCase():1)&&x.push(l);return x}([]):l.getElementsByTagName(t[1]||"*");d=0;for(j=e.length;d<j;d++)if(r=H.apply(e[d],t))b[i++]=r;if(!m.length)return b;i=0;j=b.length;for(e=0;i<j;i++){r=b[i];for(d=m.length;d--;)for(;r=Z[a[d]](r,b[i]);)if(M=H.apply(r,m[d].match(L)))break;M&&(c[e++]=b[i])}return c}function $(a,b,c){c=typeof b=="string"?c(b)[0]:b||f;if(a===window||a&&a.nodeType&&(a.nodeType==1||a.nodeType==9))return!b||a!==window&&c&&c.nodeType&&(c.nodeType==1||c.nodeType==
9)&&N(a,c)?[a]:[];if(a&&typeof a==="object"&&isFinite(a.length))return o(a);if(g=a.match(K))return(O=f.getElementById(g[1]))?[O]:[];if(g=a.match(aa))return o(c.getElementsByTagName(g[1]));return false}function P(a){var b=[],c,d;c=0;a:for(;c<a.length;c++){for(d=0;d<b.length;d++)if(b[d]==a[c])continue a;b[b.length]=a[c]}return b}function q(a,b){var c=typeof b=="string"?q(b)[0]:b||f;if(!c||!a)return[];if(g=$(a,b,q))return g;return ba(a,c)}var p,u,v,g,C,w,O,F,M,E,s,D=f.documentElement,S=/#([\w\-]+)/,
T=/\.[\w\-]+/g,K=/^#([\w\-]+$)/,ca=/^\.([\w\-]+)$/,aa=/^([\w\-]+)$/,da=/^([\w]+)?\.([\w\-]+)$/,ea=/\s*([\s\+\~>])\s*/g,Q=/[\s\>\+\~]/,R=/(?![\s\w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^'"]*\])/,Y=new RegExp("("+Q.source+")"+R.source,"g"),X=new RegExp(Q.source+R.source),V=/([.*+?\^=!:${}()|\[\]\/\\])/g,L=new RegExp(/^([a-z0-9]+)?(?:([\.\#]+[\w\-\.#]+)?)/.source+"("+/\[([\w\-]+)(?:([\|\^\$\*\~]?\=)['"]?([ \w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^]+)["']?)?\]/.source+")?("+/:([\w\-]+)(\(['"]?(\w+)['"]?\))?/.source+
")?"),Z={" ":function(a){return a&&a!==D&&a.parentNode},">":function(a,b){return a&&a.parentNode==b.parentNode&&a.parentNode},"~":function(a){return a&&a.previousSibling},"+":function(a,b,c,d){if(!a)return false;c=G(a);d=G(b);return c&&d&&c==d&&c}};k.prototype={g:function(a){return this.c[a]||undefined},s:function(a,b){return this.c[a]=b}};var B=new k,I=new k,n=new k,J=new k,N="compareDocumentPosition"in D?function(a,b){return(b.compareDocumentPosition(a)&16)==16}:"contains"in D?function(a,b){b=b==
f||b==window?D:b;return b!==a&&b.contains(a)}:function(a,b){for(;a=a.parentNode;)if(a===b)return 1;return 0},ba=f.querySelector&&f.querySelectorAll?function(a,b){if(f.getElementsByClassName&&(g=a.match(ca)))return o(b.getElementsByClassName(g[1]));return o(b.querySelectorAll(a))}:function(a,b){a=a.replace(ea,"$1");var c=[],d,i=[],e;if(g=a.match(da)){s=b.getElementsByTagName(g[1]||"*");w=B.g(g[2])||B.s(g[2],new RegExp("(^|\\s+)"+g[2]+"(\\s+|$)"));e=0;v=s.length;for(u=0;e<v;e++)w.test(s[e].className)&&
(c[u++]=s[e]);return c}e=0;s=a.split(",");for(v=s.length;e<v;e++)i[e]=W(s[e]);e=0;for(v=i.length;e<v&&(d=i[e]);e++){var j=d;if(b!==f){j=[];u=0;for(g=d.length;u<g&&(element=d[u]);u++)N(element,b)&&j.push(element)}c=c.concat(j)}return P(c)};q.uniq=P;q.pseudos={};var fa=h.qwery;q.noConflict=function(){h.qwery=fa;return this};h.qwery=q})(this,document);var ga=z.qwery;delete z.qwery;z.find=function(h,f){f=f||z.context;var k,o=null;if(h.charAt(0)==="<"&&h.charAt(h.length-1)===">")if(h.match(/</g).length===
1)return f.createElement(h.substr(1,h.length-(h.charAt(h.length-2)==="/"?3:2)));else{k=h.match(/<([a-z]+)>(.+)<\/([a-z]+)>/i);if(k.length==4&&k[1]==k[3]){o=f.createElement(k[1]);o.innerHTML=k[2]}return o}else return ga(h,f)}});
