jet().add("io",function(e){var i=e.win,l=!!i.ActiveXObject,q=!!i.XMLHttpRequest,f=function(b){return new i.ActiveXObject(b)},k=function(b){var a;try{a=f("Msxml2.DOMDocument.6.0");k=function(d){return d=="xsl"?f("Msxml2.FreeThreadedDOMDocument.6.0"):f("Msxml2.DOMDocument.6.0")}}catch(g){try{a=f("Msxml2.DOMDocument.3.0");k=function(d){return d=="xsl"?f("Msxml2.FreeThreadedDOMDocument.3.0"):f("Msxml2.DOMDocument.3.0")}}catch(c){}}return k(b)},j=function(){var b=location.host;if((location.protocol=="file:"||
b=="localhost"||b=="127.0.0.1")&&l)j=function(){return f("Microsoft.XMLHTTP")};else if(q)j=function(){return new XMLHttpRequest};else if(l)j=function(){return f("Microsoft.XMLHTTP")};return j()},n=function(b,a,g){var c=null;if(b.responseXML)c=b.responseXML;else if(i.DOMParser){c=new i.DOMParser;c=c.parseFromString(b.responseText||b,"text/xml")}else if(l){c=k(a);c.async=false;c.loadXML(b.responseText||b);c.parseError.errorCode!==0&&g("Bad status",c.parseError)}else g(0,{reason:"Can't find a suitable XML parser",
srcText:b});return c},o=function(b,a,g){a=a||b.getResponseHeader("Content-type");switch(a){case "application/xml":case "xml":case "xsl":return n(b,a,g);case "json":try{return e.JSON.parse(b.responseText)}catch(c){e.error(c)}break;default:return b.responseText}};e.IO={ajax:function(b){var a=j(),g=b.success,c=null,d=b.dataType,r=b.timeout||1E4,s=b.method||"GET",m=b.async||true,p=b.complete||function(){},t=function(){g&&g.apply(e,arguments);p.apply(e,arguments)},h=function(u,v,w){b.error&&b.error(u,
v,w);p.apply(e,arguments)};if(a){if(d&&(d==="xml"||d==="xsl")&&a.overrideMimeType)a.overrideMimeType("text/xml");if(b.url){if(m===true)a.onreadystatechange=function(){if(a.readyState===4)if(a.status===200||a.responseText||a.responseXML)t(o(a,d,h),a);else a.status===408?h("timeout",a.status,a):h("Bad status",a.status,a)};try{a.open(s,b.url,m);a.send(null)}catch(x){h("Bad status",404,a)}if(m===false)c=o(a,d,h);else setTimeout(function(){if(a.readyState!==4){a.abort();h("timeout",408,a)}},r)}}return c||
e},utils:{parseXML:n}}});
