/**
 * @module swf
 * @requires jet
 * 
 * Copyright (c) 2011, Juan Ignacio Dopazo. All rights reserved.
 * Code licensed under the BSD License
 * https://github.com/juandopazo/jet/blob/master/LICENSE.md
*/
jet.add("swf",function(p){function A(m,F,q){A.superclass.constructor.apply(this,arguments);m=p(m);q=q||{};var B=this,C=q.version||"9.0.0";q.on&&p.Object.each(q.on,function(l,D){B.on(l,D)});var y=function(l,D){console.log(l,D)};G.embedSWF(F,m,q.width,q.height,C,null,null,null,null,function(l){l=l.ref;if(!l.id)l.id="jet_flash"+p.guid();A.enableVBScript(l.id);if(l.attachEvent)l.attachEvent("FSCommand",y);else l.ownerDocument.defaultView[l.id+"_DoFSCommand"]=y})}var G=function(){function m(){if(!w){try{var a=
g.getElementsByTagName("body")[0].appendChild(g.createElement("span"));a.parentNode.removeChild(a)}catch(b){return}w=true;a=H.length;for(var c=0;c<a;c++)H[c]()}}function F(a){if(typeof n.addEventListener!=j)n.addEventListener("load",a,false);else if(typeof g.addEventListener!=j)g.addEventListener("load",a,false);else if(typeof n.attachEvent!=j)da(n,"onload",a);else if(typeof n.onload=="function"){var b=n.onload;n.onload=function(){b();a()}}else n.onload=a}function q(){var a=g.getElementsByTagName("body")[0],
b=g.createElement(r);b.setAttribute("type",I);var c=a.appendChild(b);if(c){var e=0;(function(){if(typeof c.GetVariable!=j){var d=c.GetVariable("$version");if(d){d=d.split(" ")[1].split(",");f.pv=[parseInt(d[0],10),parseInt(d[1],10),parseInt(d[2],10)]}}else if(e<10){e++;setTimeout(arguments.callee,10);return}a.removeChild(b);c=null;B()})()}else B()}function B(){var a=t.length;if(a>0)for(var b=0;b<a;b++){var c=t[b].id,e=t[b].callbackFn,d={success:false,id:c};if(f.pv[0]>0){var h=u(c);if(h)if(J(t[b].swfVersion)&&
!(f.wk&&f.wk<312)){K(c,true);if(e){d.success=true;d.ref=C(c);e(d)}}else if(t[b].expressInstall&&y()){d={};d.data=t[b].expressInstall;d.width=h.getAttribute("width")||"0";d.height=h.getAttribute("height")||"0";if(h.getAttribute("class"))d.styleclass=h.getAttribute("class");if(h.getAttribute("align"))d.align=h.getAttribute("align");var i={};h=h.getElementsByTagName("param");for(var k=h.length,o=0;o<k;o++)if(h[o].getAttribute("name").toLowerCase()!="movie")i[h[o].getAttribute("name")]=h[o].getAttribute("value");
l(d,i,c,e)}else{D(h);e&&e(d)}}else{K(c,true);if(e){if((c=C(c))&&typeof c.SetVariable!=j){d.success=true;d.ref=c}e(d)}}}}function C(a){var b=null;if((a=u(a))&&a.nodeName=="OBJECT")if(typeof a.SetVariable!=j)b=a;else if(a=a.getElementsByTagName(r)[0])b=a;return b}function y(){return!L&&J("6.0.65")&&(f.win||f.mac)&&!(f.wk&&f.wk<312)}function l(a,b,c,e){L=true;P=e||null;V={success:false,id:c};var d=u(c);if(d){if(d.nodeName=="OBJECT"){E=Q(d);M=null}else{E=d;M=c}a.id=W;if(typeof a.width==j||!/%$/.test(a.width)&&
parseInt(a.width,10)<310)a.width="310";if(typeof a.height==j||!/%$/.test(a.height)&&parseInt(a.height,10)<137)a.height="137";g.title=g.title.slice(0,47)+" - Flash Player Installation";e=f.ie&&f.win?"ActiveX":"PlugIn";e="MMredirectURL="+encodeURI(n.location).toString().replace(/&/g,"%26")+"&MMplayerType="+e+"&MMdoctitle="+g.title;if(typeof b.flashvars!=j)b.flashvars+="&"+e;else b.flashvars=e;if(f.ie&&f.win&&d.readyState!=4){e=g.createElement("div");c+="SWFObjectNew";e.setAttribute("id",c);d.parentNode.insertBefore(e,
d);d.style.display="none";(function(){d.readyState==4?d.parentNode.removeChild(d):setTimeout(arguments.callee,10)})()}R(a,b,c)}}function D(a){if(f.ie&&f.win&&a.readyState!=4){var b=g.createElement("div");a.parentNode.insertBefore(b,a);b.parentNode.replaceChild(Q(a),b);a.style.display="none";(function(){a.readyState==4?a.parentNode.removeChild(a):setTimeout(arguments.callee,10)})()}else a.parentNode.replaceChild(Q(a),a)}function Q(a){var b=g.createElement("div");if(f.win&&f.ie)b.innerHTML=a.innerHTML;
else if(a=a.getElementsByTagName(r)[0])if(a=a.childNodes)for(var c=a.length,e=0;e<c;e++)!(a[e].nodeType==1&&a[e].nodeName=="PARAM")&&a[e].nodeType!=8&&b.appendChild(a[e].cloneNode(true));return b}function R(a,b,c){var e;if(f.wk&&f.wk<312)return e;if(c)if(f.ie&&f.win){var d="";for(var h in a)if(a[h]!=Object.prototype[h])if(h.toLowerCase()=="data")b.movie=a[h];else if(h.toLowerCase()=="styleclass")d+=' class="'+a[h]+'"';else if(h.toLowerCase()!="classid")d+=" "+h+'="'+a[h]+'"';h="";for(var i in b)if(b[i]!=
Object.prototype[i])h+='<param name="'+i+'" value="'+b[i]+'" />';c.innerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+d+">"+h+"</object>";N[N.length]=a.id;e=c.firstChild}else{i=g.createElement(r);i.setAttribute("type",I);for(var k in a)if(a[k]!=Object.prototype[k])if(k.toLowerCase()=="styleclass")i.setAttribute("class",a[k]);else k.toLowerCase()!="classid"&&i.setAttribute(k,a[k]);for(d in b)if(b[d]!=Object.prototype[d]&&d.toLowerCase()!="movie"){a=d;h=b[d];k=g.createElement("param");
k.setAttribute("name",a);k.setAttribute("value",h);i.appendChild(k)}c.appendChild(i);e=i}return e}function X(a){var b=u(a);if(b&&b.nodeName=="OBJECT")if(f.ie&&f.win){b.style.display="none";(function(){if(b.readyState==4){var c=u(a);if(c){for(var e in c)if(typeof c[e]=="function")c[e]=null;c.parentNode.removeChild(c)}}else setTimeout(arguments.callee,10)})()}else b.parentNode.removeChild(b)}function u(a){var b=null;try{b=g.getElementById(a)}catch(c){}return b}function da(a,b,c){a.attachEvent(b,c);
z[z.length]=[a,b,c]}function J(a){var b=f.pv;a=a.split(".");a[0]=parseInt(a[0],10);a[1]=parseInt(a[1],10)||0;a[2]=parseInt(a[2],10)||0;return b[0]>a[0]||b[0]==a[0]&&b[1]>a[1]||b[0]==a[0]&&b[1]==a[1]&&b[2]>=a[2]?true:false}function Y(a,b,c,e){if(!(f.ie&&f.mac)){var d=g.getElementsByTagName("head")[0];if(d){c=c&&typeof c=="string"?c:"screen";if(e)S=s=null;if(!s||S!=c){e=g.createElement("style");e.setAttribute("type","text/css");e.setAttribute("media",c);s=d.appendChild(e);if(f.ie&&f.win&&typeof g.styleSheets!=
j&&g.styleSheets.length>0)s=g.styleSheets[g.styleSheets.length-1];S=c}if(f.ie&&f.win)s&&typeof s.addRule==r&&s.addRule(a,b);else s&&typeof g.createTextNode!=j&&s.appendChild(g.createTextNode(a+" {"+b+"}"))}}}function K(a,b){if(Z){var c=b?"visible":"hidden";if(w&&u(a))u(a).style.visibility=c;else Y("#"+a,"visibility:"+c)}}function $(a){return/[\\\"<>\.;]/.exec(a)!=null&&typeof encodeURIComponent!=j?encodeURIComponent(a):a}var j="undefined",r="object",I="application/x-shockwave-flash",W="SWFObjectExprInst",
n=p.config.win,g=p.config.doc,v=navigator,aa=false,H=[function(){aa?q():B()}],t=[],N=[],z=[],E,M,P,V,w=false,L=false,s,S,Z=true,f=function(){var a=typeof g.getElementById!=j&&typeof g.getElementsByTagName!=j&&typeof g.createElement!=j,b=v.userAgent.toLowerCase(),c=v.platform.toLowerCase(),e=c?/win/.test(c):/win/.test(b);c=c?/mac/.test(c):/mac/.test(b);b=/webkit/.test(b)?parseFloat(b.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false;var d=!+"\u000b1",h=[0,0,0],i=null;if(typeof v.plugins!=j&&typeof v.plugins["Shockwave Flash"]==
r){if((i=v.plugins["Shockwave Flash"].description)&&!(typeof v.mimeTypes!=j&&v.mimeTypes[I]&&!v.mimeTypes[I].enabledPlugin)){aa=true;d=false;i=i.replace(/^.*\s+(\S+\s+\S+$)/,"$1");h[0]=parseInt(i.replace(/^(.*)\..*$/,"$1"),10);h[1]=parseInt(i.replace(/^.*\.(.*)\s.*$/,"$1"),10);h[2]=/[a-zA-Z]/.test(i)?parseInt(i.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else if(typeof n.ActiveXObject!=j)try{var k=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(k)if(i=k.GetVariable("$version")){d=true;i=i.split(" ")[1].split(",");
h=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)]}}catch(o){}return{w3:a,pv:h,wk:b,ie:d,win:e,mac:c}}();(function(){if(f.w3){if(typeof g.readyState!=j&&g.readyState=="complete"||typeof g.readyState==j&&(g.getElementsByTagName("body")[0]||g.body))m();if(!w){typeof g.addEventListener!=j&&g.addEventListener("DOMContentLoaded",m,false);if(f.ie&&f.win){g.attachEvent("onreadystatechange",function(){if(g.readyState=="complete"){g.detachEvent("onreadystatechange",arguments.callee);m()}});n==top&&
function(){if(!w){try{g.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}m()}}()}f.wk&&function(){w||(/loaded|complete/.test(g.readyState)?m():setTimeout(arguments.callee,0))}();F(m)}}})();(function(){f.ie&&f.win&&window.attachEvent("onunload",function(){for(var a=z.length,b=0;b<a;b++)z[b][0].detachEvent(z[b][1],z[b][2]);a=N.length;for(b=0;b<a;b++)X(N[b]);for(var c in f)f[c]=null;f=null;for(var e in G)G[e]=null;G=null})})();return{registerObject:function(a,b,c,e){if(f.w3&&
a&&b){var d={};d.id=a;d.swfVersion=b;d.expressInstall=c;d.callbackFn=e;t[t.length]=d;K(a,false)}else e&&e({success:false,id:a})},getObjectById:function(a){if(f.w3)return C(a)},embedSWF:function(a,b,c,e,d,h,i,k,o,T){var U={success:false,node:p(b)};if(f.w3&&!(f.wk&&f.wk<312)&&a&&b&&c&&e&&d){b.css("visibility","hidden");c+="";e+="";var x={};if(o&&typeof o===r)for(var ba in o)x[ba]=o[ba];x.data=a;x.width=c;x.height=e;a={};if(k&&typeof k===r)for(var ca in k)a[ca]=k[ca];if(i&&typeof i===r)for(var O in i)if(typeof a.flashvars!=
j)a.flashvars+="&"+O+"="+i[O];else a.flashvars=O+"="+i[O];if(J(d)){d=R(x,a,b.getDOMNode());b.css("visibility","visible");U.success=true;U.ref=d}else if(h&&y()){x.data=h;l(x,a,replaceElemIdStr,T);return}else b.css("visibility","visible")}T&&T(U)},switchOffAutoHideShow:function(){Z=false},getFlashPlayerVersion:function(){return{major:f.pv[0],minor:f.pv[1],release:f.pv[2]}},hasFlashPlayerVersion:J,createSWF:function(a,b,c){if(f.w3)return R(a,b,c)},showExpressInstall:function(a,b,c,e){f.w3&&y()&&l(a,
b,c,e)},removeSWF:function(a){f.w3&&X(a)},createCSS:function(a,b,c,e){f.w3&&Y(a,b,c,e)},addDomLoadEvent:function(a){if(w)a();else H[H.length]=a},addLoadEvent:F,callDomLoadFunctions:m,getQueryParamValue:function(a){var b=g.location.search||g.location.hash;if(b){if(/\?/.test(b))b=b.split("?")[1];if(a==null)return $(b);b=b.split("&");for(var c=0;c<b.length;c++)if(b[c].substring(0,b[c].indexOf("="))==a)return $(b[c].substring(b[c].indexOf("=")+1))}return""},expressInstallCallback:function(){if(L){var a=
u(W);if(a&&E){a.parentNode.replaceChild(E,a);if(M){K(M,true);if(f.ie&&f.win)E.style.display="block"}P&&P(V)}L=false}}}}();p.extend(A,p.EventTarget);A.enableVBScript=function(m){p("<script/>").attr({type:"text/VBScript",text:"on error resume next\nSub "+m+"_FSCommand(ByVal command, ByVal args)\n  call "+m+"_DoFSCommand(command, args)\nend sub"}).appendTo("body")};p.SWF=A});
