jet().add("imageloader",function(c){var i=c.Lang,k=c.Array,h=function(){h.superclass.constructor.apply(this,arguments);var a=new Image,d=c(a),b=this.addAttrs({src:{required:true,writeOnce:true,validator:i.isString},image:{readOnly:true,value:a},node:{value:d},timeout:{value:5E3}}),e=false;b.addAttrs({type:{value:"",validator:i.isString,getter:function(g,f){return f.toLowerCase()}},loaded:{readOnly:true,getter:function(){return!!e}}}).load=function(){var g=false;a.onload=function(){b.get("type")==
"png"&&c.UA.ie&&b.set("node",c("<span/>").css({display:"inline-block",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader (src='"+b.get("src")+"',sizingMethod='crop');"}).height(a.height).width(a.width));b.fire("load");b.fire("complete");e=g=true};a.onerror=function(){b.fire("error");b.fire("complete");g=true};setTimeout(function(){if(!g){b.fire("timeout");b.fire("complete")}},b.get("timeout"));a.src=b.get("src");return b}};c.extend(h,c.Base,{setAsBackground:function(a){a=c(a);var d=this,b=
function(){var e=d.get("src");d.get("type")=="png"&&c.UA.ie?a.css("filter","progid:DXImageTransform.Microsoft.AlphaImageLoader (src='"+e+"',sizingMethod='crop');"):a.css("backgroundImage","url("+e+")")};d.get("loaded")?b():d.on("load",b);return d}});var j=function(){j.superclass.constructor.apply(this,arguments);var a=this.addAttrs({srcs:{validator:i.isArray}}),d=0;a.load=function(){var b=a.get("srcs"),e=b.length;k.each(b,function(g){var f=new h({src:g,on:{load:function(){a.fire("image:load",f)},
error:function(){a.fire("image:error",f)},timeout:function(){a.fire("image:timeout",f)},complete:function(){a.fire("image:complete",f);d++;a.fire("progress",Math.round(d*100/e),f);d==e&&a.fire("complete")}}});f.load()})}};c.extend(j,c.Base);c.add({Image:h,ImageLoader:j})});
