/**
 * @module button
 * @requires base
 * 
 * Copyright (c) 2011, Juan Ignacio Dopazo. All rights reserved.
 * Code licensed under the BSD License
 * https://github.com/juandopazo/jet/blob/master/LICENSE.md
*/
jet.add("button",function(b){var e=b.Lang,d=b.Base,f=b.Widget,h=b.WidgetParent,j=b.WidgetChild;if(!jet.Button)jet.Button={};var i=b.Button=d.create("button",f,[j],{ATTRS:{enabled:{value:true,validator:e.isBoolean},labelNode:{value:null,setter:b},labelContent:{value:null,validator:e.isString},text:{value:""}},EVENTS:{mouseover:function(){this.get("boundingBox").addClass(this.getClassName("hover"))},mouseout:function(){this.get("boundingBox").removeClass(this.getClassName("hover"))}}},{CONTENT_TEMPLATE:"<button/>",
LABEL_TEMPLATE:"<label/>",_uiFocusedChange:function(a){this.get("boundingBox").toggleClass(this.getClassName("focus"),a.newVal);this.get("contentBox")[a.newVal?"focus":"blur"]()},_uiTextChange:function(a){this.get("contentBox").html(a.val)},_uiLabelChange:function(a){var c=this.get("labelNode");a=a.newVal;if(e.isString(a)){c.html(a);c.parent()._nodes[0]||this.get("boundingBox").prepend(c)}else c.remove()},_uiEnabledChange:function(a){this.get("boundingBox").toggleClass(this.getClassName("disabled"),
!a.newVal);this.get("contentBox")._nodes[0].disabled=!a.newVal},initializer:function(){this.set("labelNode",this.get("labelNode")||this.LABEL_TEMPLATE);this._onDomFocus=b.bind(this.focus,this);this._onDomBlur=b.bind(this.blur,this)},renderUI:function(a){var c=this.getClassName("content",this._uid),g=this.get("labelNode"),k=this.get("labelContent");this.get("contentBox").attr("id",c).html(this.get("text"));g._nodes[0].setAttribute("for",c);e.isString(k)&&a.prepend(g.html(k))},bindUI:function(){var a=
this.get("contentBox");this.after("enabledChange",this._uiEnabledChange);this.after("labelContentChange",this._uiLabelChange);this.after("textChange",this._uiTextChange);this.after("focusedChange",this._uiFocusedChange);this._handlers.push(a.on("focus",this._onDomFocus,this),a.on("blur",this._onDomBlur,this))},syncUI:function(){this.get("contentBox")._nodes[0].disabled=!this.get("enabled")},destructor:function(){this.get("contentBox").unbind("focus",this._onDomFocus).unbind("blur",this._onDomBlur);
this.get("labelNode").remove()}});b.ToggleButton=d.create("button-toggle",i,[],{EVENTS:{click:function(){this.toggle()}}});b.ButtonGroup=d.create("button-group",f,[h],{ATTRS:{defaultChildType:{value:b.Button},pill:{value:false,validator:e.isBoolean}}},{_uiPillChange:function(a){this.get("boundingBox").toggleClass(this.getClassName("pill"),a.newVal)},renderUI:function(a){a.toggleClass(this.getClassName("pill"),this.get("pill"))}});b.ComboOption=d.create("combo-option",f,[j],{ATTRS:{value:{getter:function(a){return a||
this.get("text")}},text:{value:""}}},{BOUNDING_TEMPLATE:"<li/>",CONTENT_TEMPLATE:"<span/>",_uiTextChange:function(a){this.get("contentBox").html(a.newVal)},_uiOptHover:function(){this.get("boundingBox").addClass(this.getClassName("hover"))},_uiOptOut:function(){this.get("boundingBox").removeClass(this.getClassName("hover"))},bindUI:function(a){this.after("textChange",this._uiTextChange);a.on("click",this.select,this);this.on("mouseover",this._uiOptHover);this.on("mouseout",this._uiOptOut)},syncUI:function(a,
c){c.html(this.get("text"))}});b.ComboBox=d.create("combobox",f,[h],{ATTRS:{defaultChildType:{value:"ComboOption"},multiple:{value:false,readOnly:true},atLeastOne:{value:true,readOnly:true},displayNode:{value:"<span/>",setter:b},inputNode:{value:"<input/>",setter:b},arrowContainer:{value:"<span/>",setter:b},arrow:{value:"<b/>",setter:b}}},{BOUNDING_TEMPLATE:"<span/>",CONTENT_TEMPLATE:"<ul/>",_uiComboSelectionChange:function(a){if(a.newVal){this.get("displayNode").html(a.newVal.get("text"));this.get("inputNode").attr("value",
a.newVal.get("value"));setTimeout(b.bind(this._setMinWidth,this),0)}},_setMinWidth:function(){var a=this.get("contentBox"),c=this.get("boundingBox").width();a.width()<c&&a.width(c)},_toggleContent:function(){this.get("boundingBox").toggleClass(this.getClassName("expanded"))},_uiComboHide:function(a){var c=this.get("boundingBox");b(a.target).ancestor(function(g){return g==c._nodes[0]}).size()===0&&c.removeClass(this.getClassName("expanded"))},_uiContentHide:function(){this.get("boundingBox").removeClass(this.getClassName("expanded"))},
initializer:function(){this.set("displayNode",this.get("displayNode"));this.set("inputNode",this.get("inputNode"));this.set("arrowContainer",this.get("arrowContainer"));this.set("arrow",this.get("arrow"));this.after("addChild",this._setMinWidth);this.on("afterRender",this._setMinWidth)},renderUI:function(a,c){this.get("displayNode").addClass(this.getClassName("display")).prependTo(a);var g=this.get("arrowContainer").addClass(this.getClassName("arrow","container")).prependTo(a);this.get("arrow").addClass(this.getClassName("arrow")).appendTo(g);
this.get("inputNode").attr({type:"hidden",id:this.getClassName("input",this._uid)}).appendTo(a);c.addClass(this.getClassName("collapsed")).on("click",this._uiContentHide,this)},bindUI:function(){this.after("selectionChange",this._uiComboSelectionChange);this.get("arrowContainer").on("click",this._toggleContent,this);this._handlers.push(b(b.config.doc).on("click",this._uiComboHide,this))},syncUI:function(){this.get("displayNode").html(this.get("selection").get("text"));this.get("inputNode").attr("value",
this.get("selection").get("value"));this._setMinWidth()}});if(!e.isNumber(jet.Button.radio))jet.Button.radio=0;b.RadioButton=d.create("radio",i,[],{EVENTS:{afterSelectionChange:function(a){this.get("contentBox")._nodes[0].checked=!!a.newVal},render:function(){this.get("contentBox").attr({type:"radio",name:this.get("parent").get("name")})}}},{CONTENT_TEMPLATE:"<input/>"});b.RadioGroup=d.create("radio-group",f,[h],{ATTRS:{multiple:{value:false,readOnly:true},name:{writeOnce:true},defaultChildType:{value:b.RadioButton}}},
{initializer:function(){this.set("name",this.getClassName(++jet.Button.radio))}});if(!e.isNumber(jet.Button.checkbox))jet.Button.checkbox=0;b.CheckBox=d.create("checkbox",i,[],{},{CONTENT_TEMPLATE:"<input/>",_uiCheckBoxSelect:function(a){this.get("contentBox")._nodes[0].checked=!!a.newVal},renderUI:function(){this.get("contentBox").attr({type:"checkbox",name:this.get("parent").get("name")})},bindUI:function(){this.after("selectedChange",this._uiCheckBoxSelect)}});b.CheckBoxGroup=d.create("checkbox-group",
f,[h],{ATTRS:{name:{writeOnce:true},defaultChildType:{value:"CheckBox"}}},{initializer:function(){this.set("name",this.getClassName(+jet.Button.checkbox))}})});
