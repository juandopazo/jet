/**
 * @module button
 * @requires base
 * 
 * Copyright (c) 2011, Juan Ignacio Dopazo. All rights reserved.
 * Code licensed under the BSD License
 * https://github.com/juandopazo/jet/blob/master/LICENSE.md
*/
jet.add("button",function(c){var f=c.Lang,e=c.Base,g=c.Widget,h=c.WidgetParent,j=c.WidgetChild,i=jet.namespace("Button"),m=c.Button=e.create("button",g,[j],{ATTRS:{enabled:{value:true,validator:f.isBoolean},labelNode:{value:null,setter:c},labelContent:{value:null,validator:f.isString},text:{value:""}},EVENTS:{mouseover:function(){this.get("boundingBox").addClass(this.getClassName("hover"))},mouseout:function(){this.get("boundingBox").removeClass(this.getClassName("hover"))}}},{CONTENT_TEMPLATE:"<button/>",
LABEL_TEMPLATE:"<label/>",_uiFocusedChange:function(a){this.get("boundingBox").toggleClass(this.getClassName("focus"),a.newVal);this.get("contentBox")[a.newVal?"focus":"blur"]()},_uiTextChange:function(a){this.get("contentBox").html(a.val)},_uiLabelChange:function(a){var b=this.get("labelNode");a=a.newVal;if(f.isString(a)){b.html(a);b.parent().getDOMNode()||this.get("boundingBox").prepend(b)}else b.remove()},_uiEnabledChange:function(a){this.get("boundingBox").toggleClass(this.getClassName("disabled"),
!a.newVal);this.get("contentBox").getDOMNode().disabled=!a.newVal},initializer:function(){this.set("labelNode",this.get("labelNode")||this.LABEL_TEMPLATE);this.after("enabledChange",this._uiEnabledChange);this.after("labelContentChange",this._uiLabelChange);this.after("textChange",this._uiTextChange);this.after("focusedChange",this._uiFocusedChange)},renderUI:function(a,b){var d=this.getClassName("content",this._uid),k=this.get("labelNode"),l=this.get("labelContent");b.attr("id",d).html(this.get("text"));
k.getDOMNode().setAttribute("for",d);f.isString(l)&&a.prepend(k.html(l))},bindUI:function(a,b){this._handlers.push(b.on("focus",this.focus,this),b.on("blur",this.blur,this))},syncUI:function(a,b){b.getDOMNode().disabled=!this.get("enabled")},destructor:function(){this.get("labelNode").remove()}});c.ToggleButton=e.create("button-toggle",m,[],{EVENTS:{click:function(){this.toggle()}}});c.ButtonGroup=e.create("button-group",g,[h],{ATTRS:{defaultChildType:{value:c.Button},pill:{value:false,validator:f.isBoolean}}},
{_uiPillChange:function(a){this.get("boundingBox").toggleClass(this.getClassName("pill"),a.newVal)},initializer:function(){this.after("pillChange",this._uiPillChange)},renderUI:function(a){a.toggleClass(this.getClassName("pill"),this.get("pill"))}});c.ComboOption=e.create("combo-option",g,[j],{ATTRS:{value:{getter:function(a){return a||this.get("text")}},text:{value:""}}},{BOUNDING_TEMPLATE:"<li/>",CONTENT_TEMPLATE:"<span/>",_uiTextChange:function(a){this.get("contentBox").html(a.newVal)},_uiOptHover:function(){this.get("boundingBox").addClass(this.getClassName("hover"))},
_uiOptOut:function(){this.get("boundingBox").removeClass(this.getClassName("hover"))},initializer:function(){this.after("textChange",this._uiTextChange)},bindUI:function(a){a.on("click",this.select,this);this.on("mouseover",this._uiOptHover);this.on("mouseout",this._uiOptOut)},syncUI:function(a,b){b.html(this.get("text"))}});c.ComboBox=e.create("combobox",g,[h],{ATTRS:{defaultChildType:{value:"ComboOption"},multiple:{value:false,readOnly:true},atLeastOne:{value:true,readOnly:true},displayNode:{value:"<span/>",
setter:c},inputNode:{value:"<input/>",setter:c},arrowContainer:{value:"<span/>",setter:c},arrow:{value:"<b/>",setter:c}}},{BOUNDING_TEMPLATE:"<span/>",CONTENT_TEMPLATE:"<ul/>",_uiComboSelectionChange:function(a){if(a.newVal){this.get("displayNode").html(a.newVal.get("text"));this.get("inputNode").attr("value",a.newVal.get("value"));setTimeout(c.bind(this._setMinWidth,this),0)}},_setMinWidth:function(){var a=this.get("contentBox"),b=this.get("boundingBox").width();a.width()<b&&a.width(b)},_toggleContent:function(a){var b=
this.get("contentBox").getDOMNode();c(a.domEvent.target).ancestor(function(d){return d==b}).size()===0&&this.get("boundingBox").toggleClass(this.getClassName("expanded"))},_uiComboHide:function(a){var b=this.get("boundingBox");c(a.target).ancestor(function(d){return d==b.getDOMNode()}).size()===0&&b.removeClass(this.getClassName("expanded"))},_uiContentHide:function(){this.get("boundingBox").removeClass(this.getClassName("expanded"))},initializer:function(){this.set("displayNode",this.get("displayNode"));
this.set("inputNode",this.get("inputNode"));this.set("arrowContainer",this.get("arrowContainer"));this.set("arrow",this.get("arrow"));this.after("addChild",this._setMinWidth);this.on("afterRender",this._setMinWidth)},renderUI:function(a,b){this.get("displayNode").addClass(this.getClassName("display")).prependTo(a);var d=this.get("arrowContainer").addClass(this.getClassName("arrow","container")).prependTo(a);this.get("arrow").addClass(this.getClassName("arrow")).appendTo(d);this.get("inputNode").attr({type:"hidden",
id:this.getClassName("input",this._uid)}).appendTo(a);b.addClass(this.getClassName("collapsed")).on("click",this._uiContentHide,this)},bindUI:function(){this.after("selectionChange",this._uiComboSelectionChange);this.on("click",this._toggleContent);this._handlers.push(c(c.config.doc).on("click",this._uiComboHide,this))},syncUI:function(){this.get("displayNode").html(this.get("selection").get("text"));this.get("inputNode").attr("value",this.get("selection").get("value"));this._setMinWidth()}});if(!f.isNumber(i.radio))i.radio=
0;c.RadioButton=e.create("radio",m,[],{},{CONTENT_TEMPLATE:"<input/>",_rbSelectionChange:function(a){this.get("contentBox").getDOMNode().checked=!!a.newVal},initializer:function(){this.after("selectionChange",this._rbSelectionChange)},renderUI:function(a,b){b.attr({type:"radio",name:this.get("parent").get("name")})}});c.RadioGroup=e.create("radio-group",g,[h],{ATTRS:{multiple:{value:false,readOnly:true},name:{writeOnce:true},defaultChildType:{value:c.RadioButton}}},{initializer:function(){this.set("name",
this.getClassName(++i.radio))}})});
