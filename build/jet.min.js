/*
 Copyright (c) 2010, Juan Ignacio Dopazo. All rights reserved.
 Code licensed under the BSD License
 http://code.google.com/p/jet-js/wiki/Licence
*/
(function(){var D=location.protocol+"//jet-js.googlecode.com/svn/trunk/src/",l=window,o=document,s=Array.prototype,E=String.prototype,F=s.slice,G=Object.prototype.toString,H={ua:true,log:true,node:["log","ua"],xsl:["node"],swf:true,spbar:["node"],json:["node"],cookie:["node"],sizzle:["node"],base:["node"],io:["json"],"io-xdr":["node","swf","io"],"io-xsl":["io"],history:["base","json"],tabs:["base"],resize:["base",{name:"resize-css",type:"css",path:"resize/resize.css",beacon:{name:"borderLeftStyle",
value:"solid"}}],button:["base",{name:"button-css",type:"css",path:"button/button.css",beacon:{name:"borderBottomStyle",value:"solid"}}],container:["base",{name:"container-css",type:"css",path:"container/container.css",beacon:{name:"borderRightStyle",value:"solid"}}],progressbar:["base",{name:"progressbar-css",type:"css",path:"progressbar/progressbar.css",beacon:{name:"cursor",value:"pointer"}}],dragdrop:["base"],imageloader:["base"],anim:["base"],datasource:["base","io"],datatable:["datasource",
{name:"datatable-css",type:"css",path:"datatable/datatable.css",beacon:{name:"borderTopStyle",value:"solid"}}],treeview:["base"],vector:["anim"]},j=function(){var d={number:"number",string:"string",undefined:"undefined","[object Object]":"hash","[object Function]":"function","[object Array]":"array","boolean":"boolean"},b=function(a){return d[typeof a]||d[G.call(a)]||(a?"object":"null")},c=function(a){return/^s*function[^{]+{s*[native code]s*}s*$"/.test(a)};return{isNumber:function(a){return b(a)===
"number"&&isFinite(a)},isString:function(a){return b(a)==="string"},isArray:function(a){return b(a)==="array"},isHash:function(a){return b(a)==="hash"},isFunction:function(a){return b(a)==="function"},isObject:function(a,e){var h=typeof a;return a&&(h==="object"||!e&&(h==="function"||j.isFunction(a)))||false},isBoolean:function(a){return typeof a=="boolean"},isUndefined:function(a){return typeof a=="undefined"},type:b,isNative:c,isValue:function(a){var e=b(a);switch(e){case "number":return isFinite(a);
case "null":case "undefined":return false;case "boolean":return true;default:return!!e}},is:function(a){return a instanceof this},trim:c(E.trim)?function(a){return a.trim()}:function(a){a=a.replace(/^\s\s*/,"");for(var e=/\s/,h=a.length;e.test(a.charAt(--h)););return a.slice(0,h+1)},random:function(a){a=Math.random()*a;return a===0?0:Math.ceil(a)-1}}}(),m,n,t=function(d){var b;if(j.isHash(d)){b={};n.each(d,function(c,a){b[c]=t(a)})}else if(j.isArray(d)){b=[];m.each(d,function(c){b[b.length]=t(c)})}else b=
d;return b};j.clone=t;m={each:j.isNative(s.forEach)?function(d,b,c){d.forEach(b,c)}:function(d,b,c){d=d||[];var a,e=d.length;for(a=0;a<e;a++)b.call(c,d[a],a,d)},remove:function(d,b){for(var c=0,a=b.length;c<a;)if(b[c]==d)b.splice(c,1);else c++;return b},indexOf:j.isNative(s.indexOf)?function(d,b){return b.indexOf(d)}:function(d,b){var c,a=b.length;for(c=0;c<a;c+=1)if(b[c]==d)return c;return-1},inArray:function(d,b){return this.indexOf(d,b)>-1}};n={each:function(d,b,c){for(var a in d)if(d.hasOwnProperty(a))if(b.call(c||
d,a,d[a],d)===false)break},keys:function(d){var b=[];n.each(d,function(c){b[b.length]=c});return b},values:function(d){var b=[];n.each(d,function(c,a){b[b.length]=a});return b}};var w=function(d,b,c){var a=o.createElement(d);n.each(b,function(e,h){a[e]=h});n.each(c,function(e,h){a.style[e]=h});return a},x=o.getElementsByTagName("head")[0],z=function(d,b){var c=w("script",{type:"text/javascript",asyng:true,src:d});x.appendChild(c);b||setTimeout(function(){c.src=null;x.removeChild(c)},1E4)},A=function(d){x.appendChild(w("link",
{type:"text/css",rel:"stylesheet",href:d}))},u=function(d,b){o.body?d.call(o,b):setTimeout(function(){u(d,b)},13)},y=function(d,b,c){d=d||{};b=b||{};for(var a in b)if(b.hasOwnProperty(a)&&(!d[a]||c))d[a]=b[a];return d},I=function(){var d=function(e,h){h(e);for(e=e.firstChild;e;){e.nodeType!=3&&d(e,h);e=e.nextSibling}},b=function(e,h){b=h.getElementsByClassName?function(f,i){return i.getElementsByClassName(f)}:function(f,i){var k=[];d(i,function(g){var p=g.className;if(p&&m.indexOf(f,p.split(" "))>
-1)k[k.length]=g});return k};return b(e,h)},c=function(e,h){h=h||c.context;c.context=h.ownerDocument||c.context;if(j.isString(e)){e=c.parseQuery(e,h);e=!j.isValue(e)?new c.NodeList([]):new c.NodeList(e)}else e=new c.NodeList(e);return e},a=function(e){y(c,e,true)};if(l.JSON)c.JSON=l.JSON;a({win:l,context:o,parseQuery:function(e,h){h=h||c.context;var f=e.substr(0,1),i;if(f=="<")if(e.match(/</g).length==1)return h.createElement(e.substr(1,e.length-3));else{f=e.match(/<([a-z]+)>(.+)<\/([a-z]+)>/i);i=
null;if(f.length==4&&f[1]==f[3]){i=h.createElement(f[1]);i.innerHTML=f[2]}else c.error("Wrong element creation string");return i}else return f=="#"?h.getElementById(e.substr(1)):f=="."?b(e.substr(1),h):h.getElementsByTagName(e)},mix:y,add:a,walkTheDOM:d,Lang:j,Array:m,Hash:n,utils:{},Get:{script:z,css:A}});return c},q=[],B={},v={},C=function(){for(var d,b=0,c,a,e;b<q.length;){a=q[b].req;e=a.length;for(c=d=0;c<e;c++)v[a[c].name]&&d++;j.isFunction(q[b].onProgress)&&q[b].onProgress(d/e);if(d==e){d=new I;
for(c=0;c<e;c++)v[a[c].name](d);u(q.splice(b,1)[0].main,d)}else b++}};if(!l.jet){var r;u(function(){r=w("div",{id:"jet-tracker"},{position:"absolute",width:"1px",height:"1px",top:"-1000px",left:"-1000px",visibility:"hidden"});o.body.appendChild(r)});l.jet=function(d){var b=j.isHash(d)?d:{},c=D;if(b.base){c=b.base;c=c.substr(c.length-1,1)=="/"?c:c+"/"}b.minify=j.isBoolean(b.minify)?b.minify:false;b.loadCss=j.isBoolean(b.loadCss)?b.loadCss:true;var a=y(t(H),b.modules||{},true),e=function(f){A(f.fullpath||
(f.path?c+f.path:c+f.fileName+"/"+f.fileName+(b.minify?".min.css":".css")));var i=setInterval(function(){if((l.getComputedStyle?l.getComputedStyle(r,null):r.currentStyle?r.currentStyle:{})[f.beacon.name]==f.beacon.value){clearInterval(i);jet().add(f.name,function(){})}},50)},h=function(){var f=F.call(arguments),i=0,k=0,g,p;if(m.indexOf("*",f)>-1){for(;k<f.length;)if(j.isString(f[k]))f.splice(k,1);else k++;s.unshift.apply(f,n.keys(a))}else m.indexOf("io",f)==-1&&f.unshift("io");for(;i<f.length-1;){g=
f[i];p=1;if(j.isString(g))if((g=a[g.toLowerCase()])&&j.isArray(g))for(k=g.length-1;k>=0;k--)if(!m.inArray(g[k],f)){f.splice(i,0,g[k]);p=0}i+=p}l.JSON&&m.remove("json",f);for(i=0;i<f.length-1;i++){g=f[i];if(j.isString(g)&&a[g])f[i]=g=j.isHash(a[g])?a[g]:{name:g,path:g.split("-")[0]+"/"+g+(b.minify?".min.js":".js")};if(g.type=="css"&&!b.loadCss){f.splice(i,1);i--}else if(!(v[g.name]||B[g.fullpath||c+g.path])){if(!g.type||g.type=="js")z(g.fullpath||c+g.path);else g.type=="css"&&u(e,g);B[g.fullpath||
c+g.path]=1}}q.push({main:f.pop(),req:f,onProgress:b.onProgress});C()};j.isFunction(d)&&h(d);return{use:h,add:function(f,i){v[f]=i;C()}}}}})();
jet().add("io",function(f){var l=f.win,u=f.Hash,o=!!l.ActiveXObject,v=!!l.XMLHttpRequest,g=function(a){return new l.ActiveXObject(a)},q=function(a){var b=[];u.each(a,function(d,c){b.push(d+"="+c)});return b.join("&")},n=function(a){var b;try{b=g("Msxml2.DOMDocument.6.0");n=function(e){return e=="xsl"?g("Msxml2.FreeThreadedDOMDocument.6.0"):g("Msxml2.DOMDocument.6.0")}}catch(d){try{b=g("Msxml2.DOMDocument.3.0");n=function(e){return e=="xsl"?g("Msxml2.FreeThreadedDOMDocument.3.0"):g("Msxml2.DOMDocument.3.0")}}catch(c){}}return n(a)},
m=function(){var a=location.host;if((location.protocol=="file:"||a=="localhost"||a=="127.0.0.1")&&o)m=function(){return g("Microsoft.XMLHTTP")};else if(v)m=function(){return new XMLHttpRequest};else if(o)m=function(){return g("Microsoft.XMLHTTP")};return m()},r=function(a,b,d){var c=null;if(a.responseXML)c=a.responseXML;else if(l.DOMParser){c=new l.DOMParser;c=c.parseFromString(a.responseText||a,"text/xml")}else if(o){c=n(b);c.async=false;c.loadXML(a.responseText||a);c.parseError.errorCode!==0&&d("Bad status",
c.parseError)}else d(0,{reason:"Can't find a suitable XML parser",srcText:a});return c},s=function(a,b,d){b=b||a.getResponseHeader("Content-type");switch(b){case "application/xml":case "xml":case "xsl":return r(a,b,d);case "json":try{return f.JSON.parse(a.responseText)}catch(c){f.error(c)}break;default:return a.responseText}};if(!jet.IO)jet.IO={};if(!jet.IO.jsonpCallbacks)jet.IO.jsonpCallbacks=[];f.add({ajax:function(a){var b=m(),d=a.success,c=null,e=a.dataType,h=a.timeout||1E4,i=a.method||"GET",
p=a.async||true,t=a.complete||function(){},w=function(){d&&d.apply(f,arguments);t.apply(f,arguments)},j=function(x,y,z){a.error&&a.error(x,y,z);t.apply(f,arguments)},k=a.url;if(b){if(e&&(e==="xml"||e==="xsl")&&b.overrideMimeType)b.overrideMimeType("text/xml");if(k){if(k.substr(k.length-1)!="?")k+="?";if(a.data)k+=q(a.data);if(p===true)b.onreadystatechange=function(){if(b.readyState===4)if(b.status===404)j("File not found",b.status,b);else if(b.status===408)j("timeout",b.status,b);else b.status===
200||b.responseText||b.responseXML?w(s(b,e,j),b):j("Bad status",b.status,b)};try{b.open(i,k,p);b.send(null)}catch(A){j("Bad status",404,b)}if(p===false)c=s(b,e,j);else setTimeout(function(){if(b.readyState!==4){b.abort();j("timeout",408,b)}},h)}}return c||f},jsonp:function(a){a=a||{};var b=a.jsonCallbackParam||"p",d=jet.IO.jsonpCallbacks,c=d.length,e=false,h=a.url;if(h){d[c]=function(i){e=true;a.success&&a.success(i);a.complete&&a.complete(i)};if(h.substr(h.length-1)!="?")h+="?";if(!a.data)a.data=
{};settins.data[b]="jet.IO.jsonpCallbacks["+c+"]";setTimeout(function(){f.Get.script(h+q(a.data))},0);setTimeout(function(){if(!e){var i={message:"Request failed",reason:"Timeout"};a.error&&a.error(i);a.complete&&a.complete(i)}},a.timeout||1E4)}}});f.IO={utils:{parseXML:r}}});
jet().add("log",function(c){if(!jet.Log)jet.Log={};var a=jet.Log;if(!a.errors)a.errors=[];if(!a.warnings)a.warnings=[];if(!a.logs)a.logs=[];c.add({error:function(b){a.errors.push(b)},warning:function(b){a.warnings.push(b)},log:function(b){a.logs.push(b)}})});
jet().add("node",function(f){function p(a){return RegExp("(^|\\s)"+a+"(\\s|$)")}var h=f.Lang,r=f.Hash,n=f.Array,l=function(){var a={},b=function(d){b=d.detachEvent?function(g){var e,i,k;for(e in a)if(a.hasOwnProperty(e)){i=a[e];for(k=0;k<i.length;)if(i[k].obj==g){i[k].obj.detachEvent("on"+e,i[k].fn);i.splice(k,1)}else k++}}:function(g){var e,i,k;for(e in a)if(a.hasOwnProperty(e)){i=a[e];for(k=0;k<i.length;)if(i[k].obj==g){i[k].obj.removeEventListener(e,i[k].fn,false);i.splice(k,1)}else k++}};b(d)},
c=function(d){a[d]||(a[d]=[]);return a[d]};return{add:function(d,g,e){if(d.nodeType){g=c(g);g[g.length]={obj:d,fn:e}}},remove:function(d,g,e){n.remove(c(g),{obj:d,fn:e})},clear:b,flush:function(){for(var d in a)a.hasOwnProperty(d)&&b(d)}}}(),m=function(a,b,c){if(a.addEventListener)m=function(d,g,e){d.addEventListener(g,e,false);l.add(d,g,e)};else if(a.attachEvent)m=function(d,g,e){d.attachEvent("on"+g,function(i){i.target=i.srcElement;i.preventDefault=function(){i.returnValue=false};i.stopPropagation=
function(){i.cancelBubble=true};e.call(event.srcElement,i)});l.add(d,g,e)};m(a,b,c)},o=function(a,b,c){if(a.removeEventListener)o=function(d,g,e){d.removeEventListener(g,e,false);l.remove(d,g,e)};else if(a.detachEvent)o=function(d,g,e){d.detachEvent("on"+g,e);l.remove(d,g,e)};o(a,b,c)},q={getWindowFromDocument:function(a){a=a||f.context;return a.defaultView||a.parentWindow||f.win},scrollLeft:function(a){if(h.isValue(a))f.win.scrollTo(a,this.scrollTop());else{a=f.context;var b=a.defaultView;return Math.max(a.documentElement.scrollLeft,
a.body.scrollLeft,b?b.pageXOffset:0)}return this},scrollTop:function(a){if(h.isValue(a))f.win.scrollTo(this.scrollTop(),a);else{a=f.context;var b=a.defaultView;return Math.max(a.documentElement.scrollTop,a.body.scrollTop,b?b.pageYOffset:0)}return this},screenSize:function(){var a=f.context,b=a.documentElement;a=a.body;return{height:b.clientHeight||f.win.innerHeight||a.clientHeight,width:b.clientWidth||f.win.innerWidth||a.clientWidth}},pageSize:function(){var a=f.win,b=f.context,c=a.innerWidth;a=a.innerHeight;
var d=b.compatMode!="CSS1Compat"?b.body:b.documentElement;if(b.compatMode&&!f.UA.opera){c=d.clientWidth;a=d.clientHeight}return{width:Math.max(d.scrollWidth,c),height:Math.max(d.scrollHeight,a)}}},s=function(a){(this[0].ownerDocument||this[0]).body?a.call(this):setTimeout(function(){s(a)},13);return this},j=function(a,b){b=b||f.context;a=h.isValue(a)?a:[];if(j.is(a))return a;if(h.isString(a))a=[b.createElement(a)];else if(a.nodeType||a.body||a.navigator)a=[a];else if(h.isArray(a))for(var c=0;c<a.length;)if(a[c].nodeType||
a[c].body||a[c].navigator)c++;else a.splice(c,1);else if(h.isNumber(a.length)){var d=[];for(c=0;c<a.length;c++)d[c]=a[c];a=d}else f.error("Wrong argument for NodeList");d=a.length;for(c=0;c<d;c++)this[c]=a[c];this.length=d};j.prototype={each:function(a){var b,c=this.length;for(b=0;b<c;b++)a.call(this[b],this[b],b);return this},hide:function(){return this.each(function(a){var b=a.style.display;if(!a.JET_oDisplay&&b!="none")a.JET_oDisplay=b;a.style.display="none"})},show:function(){return this.each(function(a){a.style.display=
a.JET_oDisplay||""})},toggle:function(){return this.each(function(a){var b=a.style;a=a.LIB_oDisplay;b.display=b.display!="none"?"none":a?a:""})},hasClass:function(a){return p(a).test(this[0].className)},removeClass:function(a){return this.each(function(b){b.className=h.trim(b.className.replace(p(a)," "))})},addClass:function(a){return this.each(function(b){!p(a).test(b.className)&&(b.className+=(b.className?" ":"")+a)})},toggleClass:function(a){return this.each(function(b){b=f(b);b.hasClass(a)?b.removeClass(a):
b.addClass(a)})},setClass:function(a){return this.each(function(b){b.className=a})},offset:function(){var a=this[0],b={left:0,top:0,width:a.offsetWidth,height:a.offsetHeight},c=a.ownerDocument;if(a&&c)if(a.getBoundingClientRect){a=a.getBoundingClientRect();var d=c.body;c=c.documentElement;b.left=a.left+q.scrollLeft()-(c.clientLeft||d.clientLeft||0);b.top=a.top+q.scrollTop()-(c.clientTop||d.clientTop||0)}else{if(a.offsetParent){do{b.left+=a.offsetLeft;b.top+=a.offsetTop;a=a.offsetParent}while(a)}}else b=
null;return b},width:function(a){if(h.isValue(a)){if(h.isNumber(a)&&a<0)a=0;a=h.isString(a)?a:a+"px";return this.each(function(b){b.style.width=a})}return this[0].offsetWidth},height:function(a){if(h.isValue(a)){if(h.isNumber(a)&&a<0)a=0;a=h.isString(a)?a:a+"px";return this.each(function(b){b.style.height=a})}return this[0].offsetHeight},clone:function(a){a=h.isValue(a)?a:true;var b=[];this.each(function(c){b.push(c.cloneNode(a))});return new j(b)},append:function(a){a=f(a);return this.each(function(b){a.each(function(c){b.appendChild(c)})})},
appendTo:function(a){a=f(a)[0];return this.each(function(b){a.appendChild(b)})},prepend:function(a){a=f(a);return this.each(function(b){a.each(function(c){b.firstChild?b.insertBefore(c,b.firstChild):b.appendChild(c)})})},prependTo:function(a){a=f(a)[0];return this.each(function(b){a.firstChild?a.insertBefore(b,a.firstChild):a.appendChild(b)})},insertBefore:function(a){a=f(a)[0];return this.each(function(b){a.parentNode.insertBefore(b,a)})},parent:function(){var a=[];this.each(function(b){n.indexOf(b.parentNode,
a)==-1&&a.push(b.parentNode)});return new j(a)},first:function(){var a=[];this.each(function(b){(b=f(b).children(0)[0])&&a.push(b)});return new j(a)},next:function(){var a=[];this.each(function(b){do b=b.nextSibling;while(b&&b.nodeType==3);b&&a.push(b)});return new j(a)},previous:function(){var a=[];this.each(function(b){do b=b.previousSibling;while(b&&b.nodeType==3);b&&a.push(b)});return new j(a)},last:function(){var a=[];this.each(function(b){for(var c=f(b).children(),d=-1;c[++d];)b=c[d];b&&a.push(b)});
return new j(a)},html:function(a){return h.isValue(a)?this.each(function(b){b.innerHTML=a}):this[0].innerHTML},attr:function(a,b){a=a||{};var c={};if(h.isHash(a))c=a;else if(h.isValue(b))c[a]=b;else return this[0][a];return this.each(function(d){r.each(c,function(g,e){d[g]=e})})},css:function(a,b){var c={};if(h.isHash(a))c=a;else if(h.isValue(b))c[a]=b;else return f(this[0]).currentStyle()[a];return this.each(function(d){r.each(c,function(g,e){if(g=="opacity"&&f.UA.ie)d.style.filter="alpha(opacity="+
Math.ceil(e*100)+")";else{if(h.isNumber(e)&&g!="zIndex"&&g!="zoom"&&g!="opacity")e+="px";d.style[g]=e}})})},find:function(a){var b=[];this.each(function(c){f(a,c).each(function(d){b.push(d)})});return new j(b)},children:function(a){a=!h.isValue(a)?false:h.isString(a)?a.toUpperCase():a;var b=[];this.each(function(c){c=c.childNodes;for(var d=[],g=c.length,e=0;e<g;e++)if(c[e].nodeType!=3)d[d.length]=c[e];if(a!==false){g=d.length;for(e=0;e<g;e++)if(e==a||d[e].nodeName==a)b.push(d[e])}else b.push.apply(b,
d)});return new j(b)},on:function(a,b){return this.each(function(c){m(c,a,b)})},unbind:function(a,b){return this.each(function(c){o(c,a,b)})},unbindAll:function(a){return this.each(function(b){a?f.walkTheDOM(b,l.clear):l.clear(b)})},remove:function(){return this.each(function(a){f.walkTheDOM(a,l.clear);a.parentNode&&a.parentNode.removeChild(a)})},detach:function(){return this.each(function(a){a.parentNode&&a.parentNode.removeChild(a)})},getDocument:function(){var a=[];this.each(function(b){if(b.nodeName==
"IFRAME")if(b=b.contentDocument||b.contentWindow.document||b.document||null)a[a.length]=b});return f(a)},currentStyle:function(){var a=this[0];return f.win.getComputedStyle?f.win.getComputedStyle(a,null):a.currentStyle?a.currentStyle:a.style},ready:s,link:function(){var a=[];this.each(function(b){a.push(b)});n.each(arguments,function(b){b instanceof j&&b.each(function(c){a.push(c)})});return new j(a)},blur:function(){return this.each(function(a){try{a.blur()}catch(b){f.error(b)}})},focus:function(){return this.each(function(a){try{a.focus()}catch(b){f.error(b)}})},
value:function(a){return this.attr("value",a)},eq:function(a){return new j(this[a])}};j.is=h.is;n.each(["Left","Top"],function(a){j.prototype["offset"+a]=function(){return this.offset()[a.toLowerCase()]}});f.add({NodeList:j,DOM:q,pxToFloat:function(a){return h.isNumber(parseFloat(a))?parseFloat(a):h.isString(a)?parseFloat(a.substr(0,a.length-2)):a}});m(f.win,"unload",l.flush)});
jet().add("ua",function(d){d.UA=function(){var b=d.win.navigator,c=b.userAgent.toLowerCase();b=b.platform.toLowerCase();var e=/KHTML/.test(c)||/webkit/i.test(c),f=/opera/i.test(c),a=/(msie) ([\w.]+)/.exec(c);a=a&&a[1]&&a[2]?parseFloat(a[2]):false;return{webkit:e,ie:a,opera:f,gecko:!e&&!f&&!a&&/Gecko/i.test(c),win:b?/win/.test(b):/win/.test(c),mac:b?/mac/.test(b):/mac/.test(c),support:{fixed:!a||a>7&&document.documentMode>6}}}()});
